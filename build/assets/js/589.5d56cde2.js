"use strict";(self.webpackChunkmy_website_001=self.webpackChunkmy_website_001||[]).push([[589],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),u=c(n),m=i,p=u["".concat(l,".").concat(m)]||u[m]||h[m]||a;return n?r.createElement(p,o(o({ref:t},d),{},{components:n})):r.createElement(p,o({ref:t},d))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var c=2;c<a;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},19604:function(e,t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}}function u(e){return function t(){for(var n=this,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return i.length>=e.length?e.apply(this,i):function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return t.apply(n,[].concat(i,r))}}}function m(e){return{}.toString.call(e).includes("Object")}function p(e){return"function"==typeof e}n.d(t,{ZP:function(){return me},Ik:function(){return le}});var f=u((function(e,t){throw new Error(e[t]||e.default)}))({initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"}),g={changes:function(e,t){return m(t)||f("changeType"),Object.keys(t).some((function(t){return n=e,r=t,!Object.prototype.hasOwnProperty.call(n,r);var n,r}))&&f("changeField"),t},selector:function(e){p(e)||f("selectorType")},handler:function(e){p(e)||m(e)||f("handlerType"),m(e)&&Object.values(e).some((function(e){return!p(e)}))&&f("handlersType")},initial:function(e){var t;e||f("initialIsRequired"),m(e)||f("initialType"),t=e,Object.keys(t).length||f("initialContent")}};function b(e,t){return p(t)?t(e.current):t}function v(e,t){return e.current=d(d({},e.current),t),t}function y(e,t,n){return p(t)?t(e.current):Object.keys(n).forEach((function(n){var r;return null===(r=t[n])||void 0===r?void 0:r.call(t,e.current[n])})),n}var w={create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};g.initial(e),g.handler(t);var n={current:e},r=u(y)(n,t),i=u(v)(n),a=u(g.changes)(e),o=u(b)(n);function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return g.selector(e),e(n.current)}function l(e){h(r,i,a,o)(e)}return[s,l]}},x=w,k={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.33.0/min/vs"}};var M=function(e){return function t(){for(var n=this,r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return i.length>=e.length?e.apply(this,i):function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return t.apply(n,[].concat(i,r))}}};var T=function(e){return{}.toString.call(e).includes("Object")};var P={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:"Deprecation warning!\n    You are using deprecated way of configuration.\n\n    Instead of using\n      monaco.config({ urls: { monacoBase: '...' } })\n    use\n      monaco.config({ paths: { vs: '...' } })\n\n    For more please check the link https://github.com/suren-atoyan/monaco-loader#config\n  "},j=M((function(e,t){throw new Error(e[t]||e.default)}))(P),S={config:function(e){return e||j("configIsRequired"),T(e)||j("configType"),e.urls?(console.warn(P.deprecation),{paths:{vs:e.urls.monacoBase}}):e}},E=S,C=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}};var O=function e(t,n){return Object.keys(n).forEach((function(r){n[r]instanceof Object&&t[r]&&Object.assign(n[r],e(t[r],n[r]))})),a(a({},t),n)},R={type:"cancelation",msg:"operation is manually canceled"};var A,_,V=function(e){var t=!1,n=new Promise((function(n,r){e.then((function(e){return t?r(R):n(e)})),e.catch(r)}));return n.cancel=function(){return t=!0},n},D=x.create({config:k,isInitialized:!1,resolve:null,reject:null,monaco:null}),I=(_=2,function(e){if(Array.isArray(e))return e}(A=D)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(l){i=!0,a=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}(A,_)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(A,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),L=I[0],H=I[1];function N(e){return document.body.appendChild(e)}function B(e){var t,n,r=L((function(e){return{config:e.config,reject:e.reject}})),i=(t="".concat(r.config.paths.vs,"/loader.js"),n=document.createElement("script"),t&&(n.src=t),n);return i.onload=function(){return e()},i.onerror=r.reject,i}function z(){var e=L((function(e){return{config:e.config,resolve:e.resolve,reject:e.reject}})),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],(function(t){U(t),e.resolve(t)}),(function(t){e.reject(t)}))}function U(e){L().monaco||H({monaco:e})}var W=new Promise((function(e,t){return H({resolve:e,reject:t})})),F={config:function(e){var t=E.config(e),n=t.monaco,r=o(t,["monaco"]);H((function(e){return{config:O(e.config,r),monaco:n}}))},init:function(){var e=L((function(e){return{monaco:e.monaco,isInitialized:e.isInitialized}}));if(!e.isInitialized){if(H({isInitialized:!0}),e.monaco)return V(Promise.resolve(e.monaco));if(window.monaco&&window.monaco.editor)return U(window.monaco),V(Promise.resolve(window.monaco));C(N,B)(z)}return V(W)},__getMonacoInstance:function(){return L((function(e){return e.monaco}))}},q=F,G=n(67294),K=n(45697),Y=n.n(K);function Z(){return Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Z.apply(this,arguments)}const X={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};var $=function({content:e}){return G.createElement("div",{style:X},e)};var Q={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}};function J({width:e,height:t,isEditorReady:n,loading:r,_ref:i,className:a,wrapperProps:o}){return G.createElement("section",Z({style:{...Q.wrapper,width:e,height:t}},o),!n&&G.createElement($,{content:r}),G.createElement("div",{ref:i,style:{...Q.fullWidth,...!n&&Q.hide},className:a}))}J.propTypes={width:Y().oneOfType([Y().number,Y().string]).isRequired,height:Y().oneOfType([Y().number,Y().string]).isRequired,loading:Y().oneOfType([Y().element,Y().string]).isRequired,isEditorReady:Y().bool.isRequired,className:Y().string,wrapperProps:Y().object};var ee=J,te=(0,G.memo)(ee);var ne=function(e){(0,G.useEffect)(e,[])};var re=function(e,t,n=!0){const r=(0,G.useRef)(!0);(0,G.useEffect)(r.current||!n?()=>{r.current=!1}:e,t)};function ie(){}function ae(e,t,n,r){return function(e,t){return e.editor.getModel(oe(e,t))}(e,r)||function(e,t,n,r){return e.editor.createModel(t,n,r&&oe(e,r))}(e,t,n,r)}function oe(e,t){return e.Uri.parse(t)}function se({original:e,modified:t,language:n,originalLanguage:r,modifiedLanguage:i,originalModelPath:a,modifiedModelPath:o,keepCurrentOriginalModel:s,keepCurrentModifiedModel:l,theme:c,loading:d,options:h,height:u,width:m,className:p,wrapperProps:f,beforeMount:g,onMount:b}){const[v,y]=(0,G.useState)(!1),[w,x]=(0,G.useState)(!0),k=(0,G.useRef)(null),M=(0,G.useRef)(null),T=(0,G.useRef)(null),P=(0,G.useRef)(b),j=(0,G.useRef)(g);ne((()=>{const e=q.init();return e.then((e=>(M.current=e)&&x(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&console.error("Monaco initialization: error:",e))),()=>k.current?function(){const e=k.current.getModel();var t,n;s||null===(t=e.original)||void 0===t||t.dispose();l||null===(n=e.modified)||void 0===n||n.dispose();k.current.dispose()}():e.cancel()})),re((()=>{const e=k.current.getModifiedEditor();e.getOption(M.current.editor.EditorOption.readOnly)?e.setValue(t):t!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:t,forceMoveMarkers:!0}]),e.pushUndoStop())}),[t],v),re((()=>{k.current.getModel().original.setValue(e)}),[e],v),re((()=>{const{original:e,modified:t}=k.current.getModel();M.current.editor.setModelLanguage(e,r||n),M.current.editor.setModelLanguage(t,i||n)}),[n,r,i],v),re((()=>{M.current.editor.setTheme(c)}),[c],v),re((()=>{k.current.updateOptions(h)}),[h],v);const S=(0,G.useCallback)((()=>{j.current(M.current);const s=ae(M.current,e,r||n,a),l=ae(M.current,t,i||n,o);k.current.setModel({original:s,modified:l})}),[n,t,i,e,r,a,o]),E=(0,G.useCallback)((()=>{k.current=M.current.editor.createDiffEditor(T.current,{automaticLayout:!0,...h}),S(),M.current.editor.setTheme(c),y(!0)}),[h,c,S]);return(0,G.useEffect)((()=>{v&&P.current(k.current,M.current)}),[v]),(0,G.useEffect)((()=>{!w&&!v&&E()}),[w,v,E]),G.createElement(te,{width:m,height:u,isEditorReady:v,loading:d,_ref:T,className:p,wrapperProps:f})}se.propTypes={original:Y().string,modified:Y().string,language:Y().string,originalLanguage:Y().string,modifiedLanguage:Y().string,originalModelPath:Y().string,modifiedModelPath:Y().string,keepCurrentOriginalModel:Y().bool,keepCurrentModifiedModel:Y().bool,theme:Y().string,loading:Y().oneOfType([Y().element,Y().string]),options:Y().object,width:Y().oneOfType([Y().number,Y().string]),height:Y().oneOfType([Y().number,Y().string]),className:Y().string,wrapperProps:Y().object,beforeMount:Y().func,onMount:Y().func},se.defaultProps={theme:"light",loading:"Loading...",options:{},keepCurrentOriginalModel:!1,keepCurrentModifiedModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:ie,onMount:ie};var le=function(){const[e,t]=(0,G.useState)(q.__getMonacoInstance());return ne((()=>{let n;return e||(n=q.init(),n.then((e=>{t(e)}))),()=>{var e;return null===(e=n)||void 0===e?void 0:e.cancel()}})),e};var ce=function(e){const t=(0,G.useRef)();return(0,G.useEffect)((()=>{t.current=e}),[e]),t.current};const de=new Map;function he({defaultValue:e,defaultLanguage:t,defaultPath:n,value:r,language:i,path:a,theme:o,line:s,loading:l,options:c,overrideServices:d,saveViewState:h,keepCurrentModel:u,width:m,height:p,className:f,wrapperProps:g,beforeMount:b,onMount:v,onChange:y,onValidate:w}){const[x,k]=(0,G.useState)(!1),[M,T]=(0,G.useState)(!0),P=(0,G.useRef)(null),j=(0,G.useRef)(null),S=(0,G.useRef)(null),E=(0,G.useRef)(v),C=(0,G.useRef)(b),O=(0,G.useRef)(null),R=(0,G.useRef)(r),A=ce(a);ne((()=>{const e=q.init();return e.then((e=>(P.current=e)&&T(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&console.error("Monaco initialization: error:",e))),()=>j.current?function(){var e,t;null===(e=O.current)||void 0===e||e.dispose(),u?h&&de.set(a,j.current.saveViewState()):null===(t=j.current.getModel())||void 0===t||t.dispose();j.current.dispose()}():e.cancel()})),re((()=>{const n=ae(P.current,e||r,t||i,a);n!==j.current.getModel()&&(h&&de.set(A,j.current.saveViewState()),j.current.setModel(n),h&&j.current.restoreViewState(de.get(a)))}),[a],x),re((()=>{j.current.updateOptions(c)}),[c],x),re((()=>{j.current.getOption(P.current.editor.EditorOption.readOnly)?j.current.setValue(r):r!==j.current.getValue()&&(j.current.executeEdits("",[{range:j.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),j.current.pushUndoStop())}),[r],x),re((()=>{P.current.editor.setModelLanguage(j.current.getModel(),i)}),[i],x),re((()=>{void 0!==s&&j.current.revealLine(s)}),[s],x),re((()=>{P.current.editor.setTheme(o)}),[o],x);const _=(0,G.useCallback)((()=>{C.current(P.current);const s=a||n,l=ae(P.current,r||e,t||i,s);j.current=P.current.editor.create(S.current,{model:l,automaticLayout:!0,...c},d),h&&j.current.restoreViewState(de.get(s)),P.current.editor.setTheme(o),k(!0)}),[e,t,n,r,i,a,c,d,h,o]);return(0,G.useEffect)((()=>{x&&E.current(j.current,P.current)}),[x]),(0,G.useEffect)((()=>{!M&&!x&&_()}),[M,x,_]),R.current=r,(0,G.useEffect)((()=>{var e,t;x&&y&&(null===(e=O.current)||void 0===e||e.dispose(),O.current=null===(t=j.current)||void 0===t?void 0:t.onDidChangeModelContent((e=>{const t=j.current.getValue();R.current!==t&&y(t,e)})))}),[x,y]),(0,G.useEffect)((()=>{if(x){const e=P.current.editor.onDidChangeMarkers((e=>{var t;const n=null===(t=j.current.getModel())||void 0===t?void 0:t.uri;if(n){if(e.find((e=>e.path===n.path))){const e=P.current.editor.getModelMarkers({resource:n});null==w||w(e)}}}));return()=>{null==e||e.dispose()}}}),[x,w]),G.createElement(te,{width:m,height:p,isEditorReady:x,loading:l,_ref:S,className:f,wrapperProps:g})}he.propTypes={defaultValue:Y().string,defaultPath:Y().string,defaultLanguage:Y().string,value:Y().string,language:Y().string,path:Y().string,theme:Y().string,line:Y().number,loading:Y().oneOfType([Y().element,Y().string]),options:Y().object,overrideServices:Y().object,saveViewState:Y().bool,keepCurrentModel:Y().bool,width:Y().oneOfType([Y().number,Y().string]),height:Y().oneOfType([Y().number,Y().string]),className:Y().string,wrapperProps:Y().object,beforeMount:Y().func,onMount:Y().func,onChange:Y().func,onValidate:Y().func},he.defaultProps={theme:"light",loading:"Loading...",options:{},overrideServices:{},saveViewState:!0,keepCurrentModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:ie,onMount:ie,onValidate:ie};var ue=he,me=(0,G.memo)(ue)},5639:function(e,t,n){n.r(t),n.d(t,{API:function(){return st},NodeType:function(){return ht},WellKnownSceneUrls:function(){return dt},createAPI:function(){return lt},createMeasureAPI:function(){return ct}});const r=Symbol("Comlink.proxy"),i=Symbol("Comlink.endpoint"),a=Symbol("Comlink.releaseProxy"),o=Symbol("Comlink.thrown"),s=e=>"object"==typeof e&&null!==e||"function"==typeof e,l=new Map([["proxy",{canHandle:e=>s(e)&&e[r],serialize(e){const{port1:t,port2:n}=new MessageChannel;return c(e,t),[n,[n]]},deserialize:e=>(e.start(),h(e))}],["throw",{canHandle:e=>s(e)&&o in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function c(e,t=self){t.addEventListener("message",(function n(r){if(!r||!r.data)return;const{id:i,type:a,path:s}=Object.assign({path:[]},r.data),l=(r.data.argumentList||[]).map(y);let h;try{const t=s.slice(0,-1).reduce(((e,t)=>e[t]),e),n=s.reduce(((e,t)=>e[t]),e);switch(a){case 0:h=n;break;case 1:t[s.slice(-1)[0]]=y(r.data.value),h=!0;break;case 2:h=n.apply(t,l);break;case 3:h=b(new n(...l));break;case 4:{const{port1:t,port2:n}=new MessageChannel;c(e,n),h=g(t,[t])}break;case 5:h=void 0}}catch(e){h={value:e,[o]:0}}Promise.resolve(h).catch((e=>({value:e,[o]:0}))).then((e=>{const[r,o]=v(e);t.postMessage(Object.assign(Object.assign({},r),{id:i}),o),5===a&&(t.removeEventListener("message",n),d(t))}))})),t.start&&t.start()}function d(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function h(e,t){return m(e,[],t)}function u(e){if(e)throw new Error("Proxy has been released and is not useable")}function m(e,t=[],n=function(){}){let r=!1;const o=new Proxy(n,{get(n,i){if(u(r),i===a)return()=>w(e,{type:5,path:t.map((e=>e.toString()))}).then((()=>{d(e),r=!0}));if("then"===i){if(0===t.length)return{then:()=>o};const n=w(e,{type:0,path:t.map((e=>e.toString()))}).then(y);return n.then.bind(n)}return m(e,[...t,i])},set(n,i,a){u(r);const[o,s]=v(a);return w(e,{type:1,path:[...t,i].map((e=>e.toString())),value:o},s).then(y)},apply(n,a,o){u(r);const s=t[t.length-1];if(s===i)return w(e,{type:4}).then(y);if("bind"===s)return m(e,t.slice(0,-1));const[l,c]=p(o);return w(e,{type:2,path:t.map((e=>e.toString())),argumentList:l},c).then(y)},construct(n,i){u(r);const[a,o]=p(i);return w(e,{type:3,path:t.map((e=>e.toString())),argumentList:a},o).then(y)}});return o}function p(e){const t=e.map(v);return[t.map((e=>e[0])),(n=t.map((e=>e[1])),Array.prototype.concat.apply([],n))];var n}const f=new WeakMap;function g(e,t){return f.set(e,t),e}function b(e){return Object.assign(e,{[r]:!0})}function v(e){for(const[t,n]of l)if(n.canHandle(e)){const[r,i]=n.serialize(e);return[{type:3,name:t,value:r},i]}return[{type:0,value:e},f.get(e)||[]]}function y(e){switch(e.type){case 3:return l.get(e.name).deserialize(e.value);case 0:return e.value}}function w(e,t,n){return new Promise((r=>{const i=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function t(n){n.data&&n.data.id&&n.data.id===i&&(e.removeEventListener("message",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)}))}var x="undefined"!=typeof Float32Array?Float32Array:Array;function k(e){x=e}var M=Math.PI/180;function T(e){return e*M}function P(e,t){return Math.abs(e-t)<=1e-6*Math.max(1,Math.abs(e),Math.abs(t))}function j(){var e=new x(9);return x!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function S(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n+n,s=r+r,l=i+i,c=n*o,d=r*o,h=r*s,u=i*o,m=i*s,p=i*l,f=a*o,g=a*s,b=a*l;return e[0]=1-h-p,e[3]=d-b,e[6]=u+g,e[1]=d+b,e[4]=1-c-p,e[7]=m-f,e[2]=u-g,e[5]=m+f,e[8]=1-c-h,e}function E(){var e=new x(16);return x!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function C(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function O(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],c=t[7],d=t[8],h=t[9],u=t[10],m=t[11],p=t[12],f=t[13],g=t[14],b=t[15],v=n*s-r*o,y=n*l-i*o,w=n*c-a*o,x=r*l-i*s,k=r*c-a*s,M=i*c-a*l,T=d*f-h*p,P=d*g-u*p,j=d*b-m*p,S=h*g-u*f,E=h*b-m*f,C=u*b-m*g,O=v*C-y*E+w*S+x*j-k*P+M*T;return O?(O=1/O,e[0]=(s*C-l*E+c*S)*O,e[1]=(i*E-r*C-a*S)*O,e[2]=(f*M-g*k+b*x)*O,e[3]=(u*k-h*M-m*x)*O,e[4]=(l*j-o*C-c*P)*O,e[5]=(n*C-i*j+a*P)*O,e[6]=(g*w-p*M-b*y)*O,e[7]=(d*M-u*w+m*y)*O,e[8]=(o*E-s*j+c*T)*O,e[9]=(r*j-n*E-a*T)*O,e[10]=(p*k-f*w+b*v)*O,e[11]=(h*w-d*k-m*v)*O,e[12]=(s*P-o*S-l*T)*O,e[13]=(n*S-r*P+i*T)*O,e[14]=(f*y-p*x-g*v)*O,e[15]=(d*x-h*y+u*v)*O,e):null}function R(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],c=t[6],d=t[7],h=t[8],u=t[9],m=t[10],p=t[11],f=t[12],g=t[13],b=t[14],v=t[15],y=n[0],w=n[1],x=n[2],k=n[3];return e[0]=y*r+w*s+x*h+k*f,e[1]=y*i+w*l+x*u+k*g,e[2]=y*a+w*c+x*m+k*b,e[3]=y*o+w*d+x*p+k*v,y=n[4],w=n[5],x=n[6],k=n[7],e[4]=y*r+w*s+x*h+k*f,e[5]=y*i+w*l+x*u+k*g,e[6]=y*a+w*c+x*m+k*b,e[7]=y*o+w*d+x*p+k*v,y=n[8],w=n[9],x=n[10],k=n[11],e[8]=y*r+w*s+x*h+k*f,e[9]=y*i+w*l+x*u+k*g,e[10]=y*a+w*c+x*m+k*b,e[11]=y*o+w*d+x*p+k*v,y=n[12],w=n[13],x=n[14],k=n[15],e[12]=y*r+w*s+x*h+k*f,e[13]=y*i+w*l+x*u+k*g,e[14]=y*a+w*c+x*m+k*b,e[15]=y*o+w*d+x*p+k*v,e}function A(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=r+r,l=i+i,c=a+a,d=r*s,h=r*l,u=r*c,m=i*l,p=i*c,f=a*c,g=o*s,b=o*l,v=o*c;return e[0]=1-(m+f),e[1]=h+v,e[2]=u-b,e[3]=0,e[4]=h-v,e[5]=1-(d+f),e[6]=p+g,e[7]=0,e[8]=u+b,e[9]=p-g,e[10]=1-(d+m),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function _(e,t){var n=t[0],r=t[1],i=t[2],a=t[4],o=t[5],s=t[6],l=t[8],c=t[9],d=t[10];return e[0]=Math.hypot(n,r,i),e[1]=Math.hypot(a,o,s),e[2]=Math.hypot(l,c,d),e}function V(e,t,n,r,i){var a,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(r-i),e[10]=(i+r)*a,e[14]=2*i*r*a):(e[10]=-1,e[14]=-2*r),e}function D(){var e=new x(3);return x!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function I(e,t,n){var r=new x(3);return r[0]=e,r[1]=t,r[2]=n,r}function L(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function H(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function N(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function B(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function z(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function U(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.hypot(n,r,i)}function W(e,t){var n=t[0],r=t[1],i=t[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function F(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function q(e,t,n){var r=t[0],i=t[1],a=t[2],o=n[0],s=n[1],l=n[2];return e[0]=i*l-a*s,e[1]=a*o-r*l,e[2]=r*s-i*o,e}function G(e,t,n){var r=t[0],i=t[1],a=t[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o=o||1,e[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,e[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,e[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,e}function K(e,t,n){var r=t[0],i=t[1],a=t[2];return e[0]=r*n[0]+i*n[3]+a*n[6],e[1]=r*n[1]+i*n[4]+a*n[7],e[2]=r*n[2]+i*n[5]+a*n[8],e}function Y(e,t,n){var r=n[0],i=n[1],a=n[2],o=n[3],s=t[0],l=t[1],c=t[2],d=i*c-a*l,h=a*s-r*c,u=r*l-i*s,m=i*u-a*h,p=a*d-r*u,f=r*h-i*d,g=2*o;return d*=g,h*=g,u*=g,m*=2,p*=2,f*=2,e[0]=s+d+m,e[1]=l+h+p,e[2]=c+u+f,e}function Z(e,t){var n=e[0],r=e[1],i=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(n-a)<=1e-6*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=1e-6*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=1e-6*Math.max(1,Math.abs(i),Math.abs(s))}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var X=B,$=function(e){var t=e[0],n=e[1],r=e[2];return Math.hypot(t,n,r)};function Q(){var e=new x(4);return x!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function J(e,t,n,r){var i=new x(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function ee(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function te(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,e[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,e[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,e[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,e}function ne(){var e=new x(4);return x!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function re(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l+o*s,e[1]=i*l+a*s,e[2]=a*l-i*s,e[3]=o*l-r*s,e}function ie(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),l=Math.cos(n);return e[0]=r*l-a*s,e[1]=i*l+o*s,e[2]=a*l+r*s,e[3]=o*l-i*s,e}function ae(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[a]=(t[3*a+i]+t[3*i+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}D(),Q();var oe=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},se=function(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=t[0],s=t[1],l=t[2],c=t[3];return Math.abs(n-o)<=1e-6*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-s)<=1e-6*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-l)<=1e-6*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-c)<=1e-6*Math.max(1,Math.abs(a),Math.abs(c))};function le(){var e=new x(2);return x!=Float32Array&&(e[0]=0,e[1]=0),e}function ce(e,t){var n=new x(2);return n[0]=e,n[1]=t,n}function de(e,t,n){return e[0]=t,e[1]=n,e}function he(e,t,n){return e<t?e=t:e>n&&(e=n),e}D(),I(1,0,0),I(0,1,0),ne(),ne(),j(),le();const ue=function(){const e=j();return function(t){return S(e,t),e}}();function me(e){let t,n,r;const[i,a,o,s,l,c,d,h,u]=e;return t=Math.asin(-he(h,-1,1)),Math.abs(h)<.9999999?(n=Math.atan2(d,u),r=Math.atan2(a,l)):(n=Math.atan2(-o,i),r=0),{x:t,y:n,z:r}}class pe{outputPosition=D();outputRotation=ne();zoomTarget;sceneVolume;camera;domElement;mouseButtonsMap={rotate:1,pan:4,orbit:2,pivot:2};fingersMap={rotate:1,pan:2,orbit:3,pivot:3};enabled=!0;autoZoomToScene=!0;constructor(e){this.domElement=e}needPointerLock=!1;connect(){this.domElement&&(this.domElement.addEventListener("click",this.preventDefault,!1),this.domElement.addEventListener("contextmenu",this.preventDefault,!1),this.domElement.addEventListener("mousedown",this.mousedown,!1),this.domElement.addEventListener("mouseup",this.mouseup,!1),this.domElement.addEventListener("mousemove",this.mousemove,!1),this.domElement.addEventListener("wheel",this.mousewheel,!1),this.domElement.addEventListener("pointermove",this.pointermove,!1),this.domElement.addEventListener("pointerenter",this.pointerstart,!1),this.domElement.addEventListener("pointerdown",this.pointerstart,!1),this.domElement.addEventListener("pointercancel",this.pointercancel,!1),this.domElement.addEventListener("pointerout",this.pointerend,!1))}disconnect(){this.domElement&&(this.domElement.removeEventListener("click",this.preventDefault,!1),this.domElement.removeEventListener("contextmenu",this.preventDefault,!1),this.domElement.removeEventListener("mousedown",this.mousedown,!1),this.domElement.removeEventListener("mouseup",this.mouseup,!1),this.domElement.removeEventListener("mousemove",this.mousemove,!1),this.domElement.removeEventListener("wheel",this.mousewheel,!1),this.domElement.removeEventListener("pointermove",this.pointermove,!1),this.domElement.removeEventListener("pointerenter",this.pointerstart,!1),this.domElement.removeEventListener("pointerdown",this.pointerstart,!1),this.domElement.removeEventListener("pointercancel",this.pointercancel,!1),this.domElement.removeEventListener("pointerout",this.pointerend,!1))}preventDefault=e=>{e.preventDefault()};mousedown=e=>{this.camera&&this.enabled&&(this.needPointerLock=!0,e.preventDefault())};mouseup=e=>{this.camera&&this.enabled&&(e.preventDefault(),"exitPointerLock"in document&&document.exitPointerLock(),this.needPointerLock=!1)};mousewheel=e=>{this.camera&&this.enabled&&this.zoom(e.deltaY,e.offsetX,e.offsetY)};mousemove=e=>{if(this.camera&&this.enabled&&!(e.buttons<1||Math.abs(e.movementX)>100||Math.abs(e.movementY)>100))if(this.needPointerLock&&(e.currentTarget.requestPointerLock(),this.needPointerLock=!1),e.buttons&this.mouseButtonsMap.orbit){const t=j();S(t,this.outputRotation),this.orbit(e.movementX,e.movementY,t,!0)}else if(e.buttons&this.mouseButtonsMap.pan){const t=j();S(t,this.outputRotation),this.pan(e.movementX,e.movementY,t)}else e.buttons&this.mouseButtonsMap.rotate&&this.rotate(-e.movementX,-e.movementY)};pointerTable=[];_touchMovePrev=le();_touchZoomDistancePrev=0;pointerstart=e=>{if(this.camera&&this.enabled&&"mouse"!==e.pointerType)if(e.cancelable&&e.preventDefault(),e.stopPropagation(),this.pointerMoved=!1,this.pointerTable=this.pointerTable.filter((t=>t.id!==e.pointerId)),this.pointerTable.push({id:e.pointerId,x:e.offsetX,y:e.offsetY}),1===this.pointerTable.length)de(this._touchMovePrev,this.pointerTable[0].x,this.pointerTable[0].y);else{const e=this.pointerTable[0].x-this.pointerTable[1].x,t=this.pointerTable[0].y-this.pointerTable[1].y;this._touchZoomDistancePrev=Math.sqrt(e*e+t*t);const n=(this.pointerTable[0].x+this.pointerTable[1].x)/2,r=(this.pointerTable[0].y+this.pointerTable[1].y)/2;de(this._touchMovePrev,n,r)}};pointerend=e=>{if(this.camera&&this.enabled&&"mouse"!==e.pointerType)switch(e.cancelable&&e.preventDefault(),e.stopPropagation(),this.pointerTable=this.pointerTable.filter((t=>t.id!==e.pointerId)),this.pointerTable.length){case 0:break;case 1:de(this._touchMovePrev,this.pointerTable[0].x,this.pointerTable[0].y);break;default:const e=this.pointerTable[0].x-this.pointerTable[1].x,t=this.pointerTable[0].y-this.pointerTable[1].y;this._touchZoomDistancePrev=Math.sqrt(e*e+t*t);const n=(this.pointerTable[0].x+this.pointerTable[1].x)/2,r=(this.pointerTable[0].y+this.pointerTable[1].y)/2;de(this._touchMovePrev,n,r)}};pointercancel=e=>{this.camera&&this.enabled&&(e.preventDefault(),e.stopPropagation())};pointerMoved=!1;pointermove=e=>{if(!this.camera||!this.enabled)return;if("mouse"===e.pointerType)return;if(e.cancelable&&e.preventDefault(),0===e.movementX&&0===e.movementY||!this.pointerMoved&&e.movementX*e.movementX+e.movementY*e.movementY<3)return;this.pointerMoved=!0,this.pointerTable.forEach((t=>{t.id===e.pointerId&&(t.x=e.offsetX,t.y=e.offsetY)}));let{x:t,y:n}=this.pointerTable[0];if(this.pointerTable.length>1){const e=this.pointerTable[0].x-this.pointerTable[1].x,r=this.pointerTable[0].y-this.pointerTable[1].y,i=Math.sqrt(e*e+r*r);t=(this.pointerTable[0].x+this.pointerTable[1].x)/2,n=(this.pointerTable[0].y+this.pointerTable[1].y)/2;const a=this._touchZoomDistancePrev-i;this._touchZoomDistancePrev=i,this.zoom(a,t,n)}switch(this.pointerTable.length){case this.fingersMap.rotate:this.rotate(t-this._touchMovePrev[0],n-this._touchMovePrev[1]);break;case this.fingersMap.orbit:this.orbit(this._touchMovePrev[0]-t,this._touchMovePrev[1]-n,S(j(),this.outputRotation));break;case this.fingersMap.pan:this.pan(t-this._touchMovePrev[0],n-this._touchMovePrev[1],S(j(),this.outputRotation))}de(this._touchMovePrev,t,n)};update(e,t,n){this.enabled&&(e!=this.camera&&(this.camera=e,e&&this.newCamera(e)),e&&(this.sceneVolume!==t&&(this.sceneVolume=t,t&&(this.newScene(t,e),!this.zoomTarget&&this.autoZoomToScene&&(this.zoomTarget=t))),this.zoomTarget&&(this.bringIntoView(this.zoomTarget,e),this.zoomTarget=void 0)),this.animate(n),this.output(this.outputPosition,this.outputRotation),e&&(L(e.position,this.outputPosition),oe(e.rotation,this.outputRotation)))}zoomTo=e=>{this.zoomTarget=e};moveTo=(e,t)=>{};reset=()=>{this.camera&&this.newCamera(this.camera)};newScene(e,t){t.near=e.radius/5e3,t.far=10*e.radius}newCamera(e){}animate(e){}rotate(e,t){}pan(e,t,n){}orbit(e,t,n,r){}zoom(e,t,n){}}class fe extends pe{params={kind:"static",position:I(0,0,1),target:I(0,0,0),up:I(0,1,0)};constructor(e){super(),this.params={...this.params,...e}}bringIntoView(e,t){let n;switch(this.params.target=e.center,t.kind){case"pinhole":n=e.radius/Math.tan(T(t.fieldOfView)/2);break;case"orthographic":n=e.radius,t.fieldOfView=2*e.radius}if(n){const e=D();B(e,this.params.target,this.params.position);const t=1e-6;F(e,e)>t?W(e,e):H(e,0,0,1),z(e,e,n),N(this.params.position,this.params.target,e)}}output(e,t){const n=E(),r=j();var i,a;!function(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=r[0],l=r[1],c=r[2],d=i-n[0],h=a-n[1],u=o-n[2],m=d*d+h*h+u*u;m>0&&(d*=m=1/Math.sqrt(m),h*=m,u*=m);var p=l*u-c*h,f=c*d-s*u,g=s*h-l*d;(m=p*p+f*f+g*g)>0&&(p*=m=1/Math.sqrt(m),f*=m,g*=m),e[0]=p,e[1]=f,e[2]=g,e[3]=0,e[4]=h*g-u*f,e[5]=u*p-d*g,e[6]=d*f-h*p,e[7]=0,e[8]=d,e[9]=h,e[10]=u,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1}(n,this.params.position,this.params.target,this.params.up),a=n,(i=r)[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[4],i[4]=a[5],i[5]=a[6],i[6]=a[8],i[7]=a[9],i[8]=a[10],ae(t,r),L(e,this.params.position)}}class ge extends pe{params={kind:"turntable",pivotPoint:I(0,0,0),distance:20,elevation:.5,rotation:0,rotationalVelocity:30};constructor(e){super(),this.params={...this.params,...e}}bringIntoView(e,t){switch(this.params.pivotPoint=e.center,t.kind){case"pinhole":this.params.distance=e.radius/Math.tan(T(t.fieldOfView)/2);break;case"orthographic":this.params.distance=e.radius,t.fieldOfView=2*e.radius}}animate(e){for(this.params.rotation+=this.params.rotationalVelocity*e;this.params.rotation>=360;)this.params.rotation-=360;for(;this.params.rotation<0;)this.params.rotation+=360}output(e,t){const n=T(this.params.rotation),r=Math.atan2(this.params.elevation,this.params.distance),i=ne();var a,o,s;ie(i,i,n),re(t,i,-r);const l=I(0,0,(o=(a=ce(this.params.elevation,this.params.distance))[0],s=a[1],Math.hypot(o,s)));Y(l,l,t),N(e,this.params.pivotPoint,l)}}class be extends pe{params={kind:"orbit",pivotPoint:D(),distance:0,pitch:30,yaw:0,maxDistance:1e3,rotationalVelocity:.2,linearVelocity:.01};mouseButtonsMap={rotate:1,pan:2,orbit:0,pivot:0};constructor(e,t){super(t),this.params={...this.params,...e}}newCamera(e){const t=ue(e.rotation),{x:n,y:r}=me(t);this.params.yaw=r*Math.PI/180,this.params.pitch=n*Math.PI/180,this.wrapYaw(),this.clampPitch()}wrapYaw(){for(;this.params.yaw>=360;)this.params.yaw-=360;for(;this.params.yaw<0;)this.params.yaw+=360}clampPitch(){this.params.pitch=he(this.params.pitch,-89,89)}clampDistance(){this.params.distance=he(this.params.distance,0,this.params.maxDistance)}bringIntoView(e,t){switch(this.params.pivotPoint=e.center,t.kind){case"pinhole":this.params.distance=e.radius/Math.tan(T(t.fieldOfView)/2);break;case"orthographic":this.params.distance=e.radius,t.fieldOfView=2*e.radius}}newScene(e,t){super.newScene(e,t),this.params.linearVelocity=e.radius/1e3,this.params.maxDistance=50*e.radius}output(e,t){const n=T(this.params.yaw),r=T(this.params.pitch),i=ne();ie(i,i,n),re(t,i,-r);const a=I(0,0,this.params.distance);Y(a,a,t),N(e,this.params.pivotPoint,a)}rotate(e,t){this.params.yaw+=-e*this.params.rotationalVelocity,this.params.pitch+=t*this.params.rotationalVelocity,this.wrapYaw(),this.clampPitch()}pan(e,t,n){const r=I(-e*this.params.linearVelocity,0,0),i=I(0,t*this.params.linearVelocity,0),a=D();K(r,r,n),K(i,i,n),N(a,r,i),N(this.params.pivotPoint,this.params.pivotPoint,a)}zoom(e){this.params.distance+=e*this.params.linearVelocity,this.clampDistance()}}class ve extends pe{params={kind:"flight",position:D(),pivotPoint:!1,pitch:-30,yaw:30,linearVelocity:.03,autoZoomSpeed:!1,near:.1,far:5e3,flightTime:1,fieldOfView:60};distance;targetPosition=D();target_pitch=0;target_yaw=0;remainTime=-1;keys=new Set;constructor(e,t){super(t),this.params={...this.params,...e},L(this.outputPosition,this.params.position)}connect(){super.connect(),this.params.pivotPoint=!1,this.domElement.tabIndex=0,this.domElement.addEventListener("mousedown",this.handleMouseDown,!1),this.domElement.addEventListener("blur",this.blur,!1),this.domElement.addEventListener("keydown",this.keydown,!1),this.domElement.addEventListener("keyup",this.keyup,!1),this.domElement.addEventListener("pointerenter",this._pointerstart,!1),this.domElement.addEventListener("pointerdown",this._pointerstart,!1),this.domElement.addEventListener("pointerout",this._pointerstart,!1)}disconnect(){super.disconnect(),this.domElement.removeEventListener("mousedown",this.handleMouseDown,!1),this.domElement.removeEventListener("blur",this.blur,!1),this.domElement.removeEventListener("keydown",this.keydown,!1),this.domElement.removeEventListener("keyup",this.keyup,!1),this.domElement.removeEventListener("pointerenter",this._pointerstart,!1),this.domElement.removeEventListener("pointerdown",this._pointerstart,!1),this.domElement.removeEventListener("pointerout",this._pointerstart,!1)}_pointerstart=async e=>{const t=this.camera?.view;if("mouse"!==e.pointerType&&t&&this.enabled)if(e.cancelable&&e.preventDefault(),e.stopPropagation(),this.pointerTable.length===this.fingersMap.pivot){await t.updatePickBuffers();const e=await t.pick(.5*(this.pointerTable[0].x+this.pointerTable[1].x)*devicePixelRatio,.5*(this.pointerTable[0].y+this.pointerTable[1].y)*devicePixelRatio);this.params.pivotPoint=e?.position??!1,this.params.pivotPoint?(this.distance=U(this.params.pivotPoint,this.params.position),(this.distance>this.params.far||this.distance>5e4)&&(this.distance=void 0,this.params.pivotPoint=!1)):this.distance=void 0}else this.params.pivotPoint=!1};handleMouseDown=async e=>{const t=this.camera?.view;if(t&&this.enabled&&(this.domElement.focus(),e.preventDefault(),this.distance=void 0,e.buttons&this.mouseButtonsMap.pivot)){await t.updatePickBuffers();const n=await t.pick(e.offsetX*devicePixelRatio,e.offsetY*devicePixelRatio);this.params.pivotPoint=n?.position??!1,this.params.pivotPoint?(this.distance=U(this.params.pivotPoint,this.params.position),(this.distance>this.params.far||this.distance>5e4)&&(this.distance=void 0,this.params.pivotPoint=!1)):this.distance=void 0}};zoomTo=e=>{if(this.camera&&this.enabled)if(0===this.params.flightTime)this.bringIntoView(e,this.camera);else{const t=Math.max(e.radius/Math.tan(T(this.camera.fieldOfView)/2),e.radius+this.params.near);this.output(D(),this.outputRotation),N(this.targetPosition,Y(this.targetPosition,I(0,0,t),this.outputRotation),e.center),this.target_pitch=this.params.pitch,this.target_yaw=this.params.yaw,this.remainTime=this.params.flightTime,this.params.yaw+=.05}};moveTo=(e,t)=>{if(!this.enabled)return;L(this.targetPosition,e);const n=ue(t),{x:r,y:i}=me(n);this.target_yaw=180*i/Math.PI,this.target_yaw>=360?this.target_yaw-=360:this.target_yaw<0&&(this.target_yaw+=360),this.target_pitch=he(180*r/Math.PI,-89,89),this.remainTime=this.params.flightTime,this.params.yaw+=.05};animate(e){if(this.enabled){if(this.camera&&this.params.near>0&&(this.camera.near=this.params.near),this.camera&&this.params.far>0&&(this.camera.far=this.params.far),this.camera&&this.params.fieldOfView>0&&this.mouseButtonsMap.pan>0&&(this.camera.fieldOfView=this.params.fieldOfView),(e<0||e>.25)&&(e=.01666666),this.remainTime>=0){if(e>=this.remainTime)this.params.yaw=this.target_yaw,this.params.pitch=this.target_pitch,L(this.params.position,this.targetPosition);else{const l=e/this.remainTime;t=this.params.position,n=this.params.position,r=this.targetPosition,i=l,a=n[0],o=n[1],s=n[2],t[0]=a+i*(r[0]-a),t[1]=o+i*(r[1]-o),t[2]=s+i*(r[2]-s);let c=this.target_yaw-this.params.yaw;c<-180?c+=360:c>180&&(c-=360),this.params.yaw+=c*l,this.params.pitch+=(this.target_pitch-this.params.pitch)*l,this.wrapYaw(),this.clampPitch()}this.remainTime-=e}var t,n,r,i,a,o,s;if(this.keys.size){let t=1;this.keys.has("ShiftLeft")&&(t*=2),this.keys.has("ShiftRight")&&(t*=2),this.keys.has("ControlLeft")&&(t*=5),this.keys.has("ControlRight")&&(t*=5),this.keys.has("AltLeft")&&(t*=.2),this.keys.has("AltRight")&&(t*=.2);let n=0,r=0,i=0,a=this.params.linearVelocity*e*100*t;if("pinhole"==this.camera?.kind&&this.mouseButtonsMap.pan>0?(this.keys.has("KeyW")&&(i-=a),this.keys.has("KeyS")&&(i+=a)):this.camera&&(this.keys.has("KeyW")&&(this.params.fieldOfView*=.95),this.keys.has("KeyS")&&(this.params.fieldOfView*=1.05)),this.mouseButtonsMap.pan>0&&(this.keys.has("KeyA")&&(n-=a),this.keys.has("KeyD")&&(n+=a),this.keys.has("KeyQ")&&(r-=a),this.keys.has("KeyE")&&(r+=a),0!=n||0!=r||0!=i)){const e=I(n,r,i);N(this.params.position,this.params.position,Y(e,e,this.outputRotation))}let o=0,s=0,l=60*e;this.keys.has("ArrowUp")&&(o-=l),this.keys.has("ArrowDown")&&(o+=l),this.keys.has("ArrowLeft")&&(s+=l),this.keys.has("ArrowRight")&&(s-=l),0==o&&0==s||(this.params.yaw+=s,this.params.pitch+=o,this.wrapYaw(),this.clampPitch())}this.camera&&(this.camera.kind="pinhole")}}newCamera(e){}wrapYaw(){for(;this.params.yaw>=360;)this.params.yaw-=360;for(;this.params.yaw<0;)this.params.yaw+=360}clampPitch(){this.params.pitch=he(this.params.pitch,-89,89)}bringIntoView(e,t){switch(t.kind){case"pinhole":{const n=e.radius/Math.tan(T(t.fieldOfView)/2);this.output(D(),this.outputRotation),N(this.params.position,Y(this.params.position,I(0,0,n),this.outputRotation),e.center);break}case"orthographic":t.fieldOfView=2*e.radius}}newScene(e,t){super.newScene(e,t),this.params.near>0&&(t.near=this.params.near),this.params.far>0&&(t.far=this.params.far),0===this.params.linearVelocity&&(this.params.linearVelocity=.03)}output(e,t){const n=T(this.params.yaw),r=T(this.params.pitch),i=ne();ie(i,i,n),re(t,i,r),L(e,this.params.position)}rotate(e,t){const n=this.domElement.clientHeight;this.params.yaw+=e*this.camera.fieldOfView/n,this.params.pitch+=t*this.camera.fieldOfView/n,this.wrapYaw(),this.clampPitch()}pan(e,t,n){const r=this.distance&&this.camera?.fieldOfView?this.distance*Math.tan(T(this.camera.fieldOfView))/this.domElement.clientHeight:this.params.linearVelocity,i=I(-e*r,0,0),a=I(0,t*r,0),o=D();K(i,i,n),K(a,a,n),N(o,i,a),N(this.params.position,this.params.position,o)}orbit(e,t,n,r){if(this.params.pivotPoint){const n=this.params.pitch,f=this.params.yaw;r?(t*=-5,e*=-5):(t*=5,e*=5);const g=D();X(g,this.params.position,this.params.pivotPoint);const b=I(1,0,0);Y(b,b,this.outputRotation),this.rotate(e,t),t=this.params.pitch-n,e=this.params.yaw-f;const v=ne(),y=ne();(function(e,t,n){n*=.5;var r=Math.sin(n);e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n)})(v,b,T(t)),ie(y,y,T(e));const w=ne();i=w,o=v,s=(a=y)[0],l=a[1],c=a[2],d=a[3],h=o[0],u=o[1],m=o[2],p=o[3],i[0]=s*p+d*h+l*m-c*u,i[1]=l*p+d*u+c*h-s*m,i[2]=c*p+d*m+s*u-l*h,i[3]=d*p-s*h-l*u-c*m;const x=S(j(),w);N(this.params.position,K(g,g,x),this.params.pivotPoint)}else this.pan(e,t,n);var i,a,o,s,l,c,d,h,u,m,p}zoom(e,t,n){const r=this.domElement.clientWidth,i=this.domElement.clientHeight;if("pinhole"==this.camera?.kind){const a=E();V(a,T(this.camera.fieldOfView),r/i,this.camera.near,this.camera.far);const o=I(2*t/r-1,1-2*n/i,0);O(a,a),G(o,o,a);const s=j();if(S(s,this.outputRotation),K(o,o,s),W(o,o),this.mouseButtonsMap.pan<1){const a=.001*e,o=Math.min(90,this.camera.fieldOfView*(1+a)),s=o-this.camera.fieldOfView;if(0===s)return;this.camera.fieldOfView=o;const l=s*(t-.5*r)/i,c=s*(n/i-.5);return this.params.yaw+=l,this.params.pitch+=c,this.wrapYaw(),void this.clampPitch()}let l=this.params.autoZoomSpeed&&this.distance?this.distance*Math.tan(T(this.camera.fieldOfView))/i:this.params.linearVelocity;this.keys.size&&(this.keys.has("ShiftLeft")&&(l*=2),this.keys.has("ShiftRight")&&(l*=2),this.keys.has("ControlLeft")&&(l*=5),this.keys.has("ControlRight")&&(l*=5),this.keys.has("AltLeft")&&(l*=.2),this.keys.has("AltRight")&&(l*=.2)),z(o,o,-e*l),N(this.params.position,this.params.position,o)}else if("orthographic"==this.camera?.kind){const a=e/500;if(this.params.fieldOfView*=1+a,e<0){const e=n/i-.5,a=I((t/r-.5)*this.params.fieldOfView,e*this.params.fieldOfView*-1,0);N(this.params.position,this.params.position,Y(a,a,this.outputRotation))}}}blur=e=>{"exitPointerLock"in document&&document.exitPointerLock(),this.keys.clear()};keydown=e=>{switch(e.code){case"KeyW":case"KeyS":case"KeyA":case"KeyD":case"KeyQ":case"KeyE":e.preventDefault()}this.keys.add(e.code)};keyup=e=>{switch(e.code){case"KeyW":case"KeyS":case"KeyA":case"KeyD":case"KeyQ":case"KeyE":e.preventDefault()}this.keys.delete(e.code)}}class ye extends pe{params={kind:"ortho",referenceCoordSys:E(),position:D(),linearVelocity:.01,near:.1,far:5e3,fieldOfView:2};keys=new Set;update(e,t,n){super.update(e,t,n);const{params:r}=this;e&&(e.far=r.far,e.near=r.near)}constructor(e,t){super(t),this.params={...this.params,...e}}connect(){super.connect(),this.domElement.tabIndex=0,this.domElement.addEventListener("mousedown",this.handleMouseDown,!1),this.domElement.addEventListener("blur",this.blur,!1),this.domElement.addEventListener("keydown",this.keydown,!1),this.domElement.addEventListener("keyup",this.keyup,!1),this.domElement.addEventListener("pointerenter",this._pointerstart,!1),this.domElement.addEventListener("pointerdown",this._pointerstart,!1),this.domElement.addEventListener("pointerout",this._pointerstart,!1)}disconnect(){super.disconnect(),this.domElement.removeEventListener("mousedown",this.handleMouseDown,!1),this.domElement.removeEventListener("blur",this.blur,!1),this.domElement.removeEventListener("keydown",this.keydown,!1),this.domElement.removeEventListener("keyup",this.keyup,!1),this.domElement.removeEventListener("pointerenter",this._pointerstart,!1),this.domElement.removeEventListener("pointerdown",this._pointerstart,!1),this.domElement.removeEventListener("pointerout",this._pointerstart,!1)}_pointerstart=async e=>{const t=this.camera?.view;"mouse"!==e.pointerType&&t&&(e.cancelable&&e.preventDefault(),e.stopPropagation())};handleMouseDown=async e=>{const t=this.camera?.view;t&&(this.domElement.focus(),e.preventDefault(),e.buttons,this.mouseButtonsMap.pivot)};zoomTo=e=>{this.camera&&this.bringIntoView(e,this.camera)};animate(e){if(this.camera&&this.params.near>0&&(this.camera.near=this.params.near),this.camera&&this.params.far>0&&(this.camera.far=this.params.far),this.camera&&this.params.fieldOfView>0&&(this.camera.fieldOfView=this.params.fieldOfView),this.keys.size){let t=1;this.keys.has("ShiftLeft")&&(t*=2),this.keys.has("ShiftRight")&&(t*=2),this.keys.has("ControlLeft")&&(t*=5),this.keys.has("ControlRight")&&(t*=5),this.keys.has("AltLeft")&&(t*=.2),this.keys.has("AltRight")&&(t*=.2);let n=0,r=0,i=this.params.linearVelocity*e*100*t;if(this.camera&&(this.keys.has("KeyQ")&&(this.params.fieldOfView*=.99),this.keys.has("KeyE")&&(this.params.fieldOfView*=1.01)),this.keys.has("KeyA")&&(n-=i*this.params.fieldOfView),this.keys.has("KeyD")&&(n+=i*this.params.fieldOfView),this.keys.has("KeyW")&&(r+=i*this.params.fieldOfView),this.keys.has("KeyS")&&(r-=i*this.params.fieldOfView),0!=n||0!=r){const e=I(n,r,0);N(this.params.position,this.params.position,e)}}this.camera&&(this.camera.kind="orthographic")}newCamera(e){}bringIntoView(e,t){t.fieldOfView=2*e.radius}newScene(e,t){super.newScene(e,t),this.params.near>0&&(t.near=this.params.near),this.params.far>0&&(t.far=this.params.far),0===this.params.linearVelocity&&(this.params.linearVelocity=e.radius/1e3)}output(e,t){const{position:n,referenceCoordSys:r}=this.params;!function(e,t){var n=new x(3);_(n,t);var r=1/n[0],i=1/n[1],a=1/n[2],o=t[0]*r,s=t[1]*i,l=t[2]*a,c=t[4]*r,d=t[5]*i,h=t[6]*a,u=t[8]*r,m=t[9]*i,p=t[10]*a,f=o+d+p,g=0;f>0?(g=2*Math.sqrt(f+1),e[3]=.25*g,e[0]=(h-m)/g,e[1]=(u-l)/g,e[2]=(s-c)/g):o>d&&o>p?(g=2*Math.sqrt(1+o-d-p),e[3]=(h-m)/g,e[0]=.25*g,e[1]=(s+c)/g,e[2]=(u+l)/g):d>p?(g=2*Math.sqrt(1+d-o-p),e[3]=(u-l)/g,e[0]=(s+c)/g,e[1]=.25*g,e[2]=(h+m)/g):(g=2*Math.sqrt(1+p-o-d),e[3]=(s-c)/g,e[0]=(u+l)/g,e[1]=(h+m)/g,e[2]=.25*g)}(t,r),G(e,n,r)}pan(e,t){const n=this.params.fieldOfView/this.domElement.clientHeight;N(this.params.position,this.params.position,I(-e*n,t*n,0))}zoom(e,t,n){const r=e/500;this.params.fieldOfView*=1+r}blur=e=>{"exitPointerLock"in document&&document.exitPointerLock(),this.keys.clear()};keydown=e=>{switch(e.code){case"KeyW":case"KeyS":case"KeyA":case"KeyD":case"KeyQ":case"KeyE":e.preventDefault()}this.keys.add(e.code)};keyup=e=>{switch(e.code){case"KeyW":case"KeyS":case"KeyA":case"KeyD":case"KeyQ":case"KeyE":e.preventDefault()}this.keys.delete(e.code)};init(e,t,n){const{params:r}=this;if(t){const o=(i=t,(a=new x(3))[0]=i[0],a[1]=i[1],a[2]=i[2],a),s=I(0,1,0);Y(s,s,n.rotation);const l=q(D(),s,o);!function(e){const[t,n,r]=e;e[0]=e[1]=e[2]=0;const i=Math.abs(t),a=Math.abs(n),o=Math.abs(r);i>a&&i>o?e[0]=Math.sign(t):a>o?e[1]=Math.sign(n):e[2]=Math.sign(r)}(l),q(s,o,l),W(s,s),q(l,s,o),W(l,l);const c=function(e,t,n,r,i,a,o,s,l){var c=new x(9);return c[0]=e,c[1]=t,c[2]=n,c[3]=r,c[4]=i,c[5]=a,c[6]=o,c[7]=s,c[8]=l,c}(l[0],l[1],l[2],s[0],s[1],s[2],o[0],o[1],o[2]),d=ae(ne(),c),h=A(E(),d,e);r.referenceCoordSys=h,H(r.position,0,0,1)}else{const e=S(j(),n.rotation),t=n.position;r.referenceCoordSys=function(e,t,n,r,i,a,o,s,l,c,d,h,u,m,p,f){var g=new x(16);return g[0]=e,g[1]=t,g[2]=n,g[3]=0,g[4]=i,g[5]=a,g[6]=o,g[7]=0,g[8]=l,g[9]=c,g[10]=d,g[11]=0,g[12]=u,g[13]=m,g[14]=p,g[15]=1,g}(e[0],e[1],e[2],0,e[3],e[4],e[5],0,e[6],e[7],e[8],0,t[0],t[1],t[2])}var i,a;if(H(r.position,0,0,1),"pinhole"==n.kind){const t=n.getDistanceFromViewPlane(e),i=Math.max(.1,t)*Math.tan(Math.PI/180*n.fieldOfView/2)*2;r.fieldOfView=i}}}class we{view;kind="pinhole";_controller=new fe({kind:"static"});position=D();rotation=ne();fieldOfView=45;near=.1;far=1e3;generation=0;previousState={position:D(),rotation:ne(),fieldOfView:0,near:0,far:0,kind:"pinhole"};viewClipMatrix=E();viewWorldMatrix=E();viewFrustum={left:Q(),right:Q(),top:Q(),bottom:Q(),near:Q(),far:Q(),image:Q()};constructor(e){this.view=e}get controller(){return this._controller}set controller(e){this._controller!=e&&(this._controller.disconnect(),this._controller=e,this._controller.connect())}getDistanceFromViewPlane(e){const{position:t,rotation:n}=this,r=I(0,0,-1);Y(r,r,n);const i=-F(r,t);return F(e,r)+i}update(e){const{position:t,rotation:n,fieldOfView:r,generation:i}=this;this.updateState();const{viewClipMatrix:a,viewWorldMatrix:o,viewFrustum:s}=this;if("orthographic"==this.kind){const i=r/2,l=i*e;!function(e,t,n,r,i,a,o){var s=1/(t-n),l=1/(r-i),c=1/(a-o);e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*l,e[14]=(o+a)*c,e[15]=1}(a,-l,l,-i,i,this.near,this.far),A(o,n,t);const{left:c,right:d,top:h,bottom:u,near:m,far:p,image:f}=s;ee(c,-1,0,0,l),ee(d,1,0,0,l),ee(h,0,1,0,i),ee(u,0,-1,0,i),ee(m,0,0,1,-this.near),ee(p,0,0,-1,this.far),ee(f,0,0,-1,0)}else{V(a,T(r),e,this.near,this.far),A(o,n,t);const i=T(r/2),l=Math.atan(Math.tan(i)*e),{left:c,right:d,top:h,bottom:u,near:m,far:p,image:f}=s;ee(c,-Math.cos(l),0,Math.sin(l),0),ee(d,Math.cos(l),0,Math.sin(l),0),ee(h,0,Math.cos(i),Math.sin(i),0),ee(u,0,-Math.cos(i),Math.sin(i),0),ee(m,0,0,1,-this.near),ee(p,0,0,-1,this.far),ee(f,0,0,-1,0)}return{generation:i,viewFrustum:s,viewClipMatrix:a,viewWorldMatrix:o}}get hasChanged(){const{previousState:e}=this;return!(Z(e.position,this.position)&&se(e.rotation,this.rotation)&&P(e.fieldOfView,this.fieldOfView)&&P(e.near,this.near)&&P(e.far,this.far)&&e.kind==this.kind)}updateState(){const{hasChanged:e}=this;if(e){const{previousState:e}=this;L(e.position,this.position),oe(e.rotation,this.rotation),e.fieldOfView=this.fieldOfView,e.near=this.near,e.far=this.far,e.kind=this.kind,this.generation++}return e}}var xe;function ke(e,t){return 4*e+t}!function(e){e[e.Model=0]="Model",e[e.World=1]="World",e[e.View=2]="View",e[e.Clip=3]="Clip"}(xe||(xe={}));const Me=[0,0,0],Te=[0,0,0];function Pe(e){return{modelWorldMatrix:e.getMatrix(xe.Model,xe.World),modelViewMatrix:e.getMatrix(xe.Model,xe.View),modelClipMatrix:e.getMatrix(xe.Model,xe.Clip),clipViewMatrix:e.getMatrix(xe.Clip,xe.View),clipWorldMatrix:e.getMatrix(xe.Clip,xe.World),clipModelMatrix:e.getMatrix(xe.Clip,xe.Model),worldViewMatrix:e.getMatrix(xe.World,xe.View),worldClipMatrix:e.getMatrix(xe.World,xe.Clip),viewWorldMatrix:e.getMatrix(xe.View,xe.World),viewModelMatrix:e.getMatrix(xe.View,xe.Model),viewClipMatrix:e.getMatrix(xe.View,xe.Clip),worldModelMatrix:e.getMatrix(xe.World,xe.Model)}}function je(e){return{modelWorldNormalMatrix:e.getMatrixNormal(xe.Model,xe.World),modelViewNormalMatrix:e.getMatrixNormal(xe.Model,xe.View),modelClipNormalMatrix:e.getMatrixNormal(xe.Model,xe.Clip),clipViewNormalMatrix:e.getMatrixNormal(xe.Clip,xe.View),clipWorldNormalMatrix:e.getMatrixNormal(xe.Clip,xe.World),clipModelNormalMatrix:e.getMatrixNormal(xe.Clip,xe.Model),worldViewNormalMatrix:e.getMatrixNormal(xe.World,xe.View),worldClipNormalMatrix:e.getMatrixNormal(xe.World,xe.Clip),viewWorldNormalMatrix:e.getMatrixNormal(xe.View,xe.World),viewModelNormalMatrix:e.getMatrixNormal(xe.View,xe.Model),viewClipNormalMatrix:e.getMatrixNormal(xe.View,xe.Clip),worldModelNormalMatrix:e.getMatrixNormal(xe.World,xe.Model)}}class Se{_mtx4=new Array(16);_mtx3=new Array(16);constructor(e,t,n){this._mtx4[ke(xe.Model,xe.World)]=e,this._mtx4[ke(xe.View,xe.World)]=t,this._mtx4[ke(xe.View,xe.Clip)]=n;const r=this._mtx4[ke(xe.World,xe.Model)]=E(),i=this._mtx4[ke(xe.World,xe.View)]=E(),a=this._mtx4[ke(xe.Clip,xe.View)]=E();O(r,e),O(i,t),O(a,n)}getMatrix(e,t){const n=ke(e,t);let r=this._mtx4[n];return r||(this._mtx4[n]=r=E(),t>e?R(r,this.getMatrix(t-1,t),this.getMatrix(e,t-1)):R(r,this.getMatrix(e-1,t),this.getMatrix(e,e-1))),r}getMatrixNormal(e,t){const n=ke(e,t);let r=this._mtx3[n];var i,a,o,s,l,c,d,h,u,m,p,f,g,b,v,y,w,x,k,M,T,P,S,E,C,O,R,A,_,V,D;return r||(this._mtx3[n]=r=j(),i=r,o=(a=this.getMatrix(e,t))[0],s=a[1],l=a[2],c=a[3],d=a[4],h=a[5],u=a[6],m=a[7],p=a[8],f=a[9],g=a[10],b=a[11],v=a[12],y=a[13],w=a[14],(D=(k=o*h-s*d)*(V=g*(x=a[15])-b*w)-(M=o*u-l*d)*(_=f*x-b*y)+(T=o*m-c*d)*(A=f*w-g*y)+(P=s*u-l*h)*(R=p*x-b*v)-(S=s*m-c*h)*(O=p*w-g*v)+(E=l*m-c*u)*(C=p*y-f*v))&&(D=1/D,i[0]=(h*V-u*_+m*A)*D,i[1]=(u*R-d*V-m*O)*D,i[2]=(d*_-h*R+m*C)*D,i[3]=(l*_-s*V-c*A)*D,i[4]=(o*V-l*R+c*O)*D,i[5]=(s*R-o*_-c*C)*D,i[6]=(y*E-w*S+x*P)*D,i[7]=(w*T-v*E-x*M)*D,i[8]=(v*S-y*T+x*k)*D)),r}}class Ee{view;deviceProfile;_nodeSize=-100;_timers=[];_maxTriangles=navigator.userAgent.match(/Android/i)?performance.memory.jsHeapSizeLimit<1073741824?5e6:1e7:navigator.userAgent.match(/Intel Mac OS/i)?1e7:navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?5e6:15e6;tolerance=[25,20];highTolerance=navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Intel Mac OS/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?[45,40]:[55,50];_state=-1;_allowUp=!0;constructor(e,t){this.view=e,this.deviceProfile=t}get active(){return 2!==this._state}_capWait=0;setValue(e){const{quality:t}=this.view.settings;this.view.applySettings({quality:{detail:{value:Math.pow(10,e),autoAdjust:t.detail.autoAdjust},resolution:t.resolution}})}update(e,t,n){const r=this.view.settings,{detail:i}=r.quality,{autoAdjust:a}=i;if(!a?.enabled)return;let o=Math.log10(i.value).toFixed(2);if(this._nodeSize<-10&&(this._nodeSize=+o),!r.diagnostics.holdDynamic){if(t.triangles+t.points/2>this.deviceProfile.triangleLimit){const e=+o+.05;return e>this._nodeSize&&(this._nodeSize=e),o=e.toFixed(2),this.setValue(+o),t.renderResolved=!1,this._state=2,void(this._timers.length=0)}if(!(e>1e3)){if(this._timers.push(e),n)this._allowUp=!0,this._state=0,o!==this._nodeSize.toFixed(2)&&this.setValue(this._nodeSize);else{if(!this._allowUp||this._state>1){if(!t.renderResolved)return;if(2===this._state||!t.sceneResolved)return;const e=+o;return this._state=2,void(e>+a.min.toFixed(2)&&(o=(+o-.05).toFixed(2),t.sceneResolved=!1,t.renderResolved=!1,this.setValue(+o),this._state=3))}if(!t.renderResolved||!t.sceneResolved)return}if(this._state<2&&t.renderResolved){let e=0;for(let t of this._timers)e+=t;if(this._timers.length<20)return;e=1e3*this._timers.length/e;const n=[this.deviceProfile.targetFPS,this.deviceProfile.targetFPS+5];this._allowUp&&e>n[0]?t.sceneResolved&&(this._state=-1,this._nodeSize-=.05):e<n[1]?(this._nodeSize+=.05,this._allowUp=!1,this._state=1):this._state=0}this._timers=[],this._nodeSize<a.min?(this._nodeSize=a.min,this._state=2):this._nodeSize>a.max&&(this._nodeSize=a.max,this._state=0),o!==this._nodeSize.toFixed(2)&&(t.sceneResolved=!1,t.renderResolved=!1,this.setValue(this._nodeSize))}}}}class Ce{view;_enabled=!1;step=.1;_targetWidth=0;_targetHeight=0;_curStep=0;_timers=[[],[]];_weak=!0;tolerance=[30,25];wasDown=!1;wasUp=!1;lastDT=0;calmCount=0;initRun=1;lastNoSSAOFps=0;weakDevice=2;constructor(e){this.view=e}get active(){return this._enabled||this.initRun>0}get isInitializing(){return this.initRun>0}setValue(e){const{quality:t}=this.view.settings;this.view.applySettings({quality:{resolution:{value:e,autoAdjust:t.resolution.autoAdjust},detail:t.detail}})}update(e,t,n,r,i){const a=this.view.settings,{resolution:o}=a.quality,{autoAdjust:s}=o,l=s.max;if(!s?.enabled)return this._enabled=!1,void this.setValue(l);if(n||this.initRun){this.calmCount=0,this._enabled=!0,this.wasDown=!1,this.wasUp=!1;const e=l-this.step*this._curStep;o.value!==e&&this.setValue(e)}else if(!this._enabled||!r)return this._enabled=!1,void this.setValue(l);if(e>2e3)return;const c=this._timers[i?1:0];if(c.push(e),c.length<25)return;e=0;for(let h of c)e+=h;e=2*e/c.length;const d=c.filter((t=>t<e));e=0;for(let h of d)e+=h;if(e=1e3*d.length/e,this.initRun&&0===this._curStep)i||!t.weakDevice?(e<.9*this.lastNoSSAOFps&&(t.weakDevice=!0),this.initRun--):(this.initRun--,e>50&&(t.weakDevice=!1,this.initRun=1,this.lastNoSSAOFps=e));else{const n=(l-Math.max(.2,s.min))/this.step;this._curStep>0&&(e>this.tolerance[0]||this.wasDown&&e<=1.05*this.lastDT)?(this._curStep--,this.calmCount=0,this.wasUp=!0):e<this.tolerance[1]&&this._curStep<n&&!this.wasUp?(t.renderResolved&&(this.lastDT=e,this._curStep++,this.wasDown=!0),this.calmCount=0):(this.calmCount++,this._curStep>0&&(this.initRun=0),this._enabled=this.calmCount<4),this.setValue(l-this.step*this._curStep)}c.length=0}setSize(e,t,n){const{autoAdjust:r}=n.quality.resolution;if(void 0===r||!r.enabled||e===this._targetWidth&&t===this._targetHeight)return;const i=r.max;this.wasDown=!1,this.lastDT=0,this.calmCount=0,this._targetWidth/e<.3&&(this._curStep=Math.round((i-(e>1280?1280/e:n.quality.resolution.value))/this.step),this.setValue(i-this.step*this._curStep)),this._targetHeight*this._targetWidth>e*t&&(this.initRun=1,this.weakDevice=1),this._targetWidth=e,this._targetHeight=t,this._timers=[[],[]]}}class Oe{itemRefs=[];add(e){const t=(n=e,"WeakRef"in self?new WeakRef(n):{[Symbol.toStringTag]:"WeakRef",deref:()=>n});var n;this.itemRefs.push(t)}remove(e){const t=this.itemRefs.findIndex((t=>t.deref()==e));this.itemRefs.splice(t,1)}*[Symbol.iterator](){const{itemRefs:e}=this,t=[];for(let n=0;n<e.length;n++){const r=e[n].deref();r?yield r:t.push(n)}t.reverse();for(const n of t)e.splice(n,1)}}function Re(e){if("object"!=typeof e)return e;let t;const n=e.constructor;switch(n){case RegExp:t=new RegExp(e);break;case Date:t=new Date(e.getTime());break;default:t=n?new n:Object.create(null)}for(var r in e){const n=e[r];"function"!=typeof n&&(t[r]=Re(n))}return t}const Ae=Symbol("scope");function _e(e,...t){for(const n of t)if(void 0!==n)for(const t of Reflect.ownKeys(n))void 0!==e[t]&&(`#${t.toString()}`in e||e[t]!==Object(e[t])?Reflect.set(e,t,n[t]):_e(e[t],n[t]))}function Ve(e){return Reflect.defineProperty(e,Ae,{enumerable:!1}),e}class De{onChange;proxy;constructor(e,t){this.onChange=e,this.proxy=t??Object.create(null)}wrap(e){for(let t in e){const n=e[t];"object"==typeof n&&Ae in n?this.scope(t,n):this.mutable(t,n)}}mutable(e,t){const{proxy:n,onChange:r}=this;"object"==typeof t&&(t=Array.isArray(t)?[...t]:{...t},Object.seal(t));const i=`#${e.toString()}`;Reflect.defineProperty(n,i,{enumerable:!1,value:t,writable:!0}),Reflect.defineProperty(n,e,{enumerable:!0,get:function(){return this[i]},set:function(e){this[i]!=e&&(this[i]=e,r())}})}scope(e,t){const{proxy:n,onChange:r}=this,i=new De(r);i.wrap(t),Reflect.defineProperty(n,e,{enumerable:!0,writable:!1,value:i.proxy})}}const Ie={display:Ve({width:150,height:100}),grid:Ve({enabled:!1,majorLineCount:21,minorLineCount:0,origo:D(),axisX:I(1,0,0),axisY:I(0,1,0),majorColor:[.5,1,.5],minorColor:[1,.5,.5]}),background:Ve({color:[0,0,.25,1]}),clippingPlanes:Ve({enabled:!1,inside:!0,showBox:!1,bounds:Ve({min:D(),max:D()}),highlight:0}),clippingVolume:Ve({enabled:!1,mode:"union",planes:[]}),environment:void 0,exposure:0,light:Ve({ambient:{brightness:.1},camera:Ve({brightness:0,distance:10}),sun:Ve({brightness:1,position:Ve({azimuth:135,inclination:45})})}),objectHighlights:[],points:Ve({shape:"disc",size:Ve({pixel:1,maxPixel:void 0,metric:0,toleranceFactor:0}),deviation:Ve({mode:"mix",colors:[{deviation:-1,color:[1,0,0,1]},{deviation:-.5,color:[1,1,0,1]},{deviation:-.45,color:[1,1,0,0]},{deviation:.45,color:[1,1,0,0]},{deviation:.5,color:[1,1,0,1]},{deviation:1,color:[0,1,0,1]}]}),intensity:Ve({mode:"mix",colors:[{intensity:0,color:[1,0,0,0]},{intensity:.5,color:[1,1,0,.5]},{intensity:1,color:[0,1,0,1]}]})}),ocean:Ve({enabled:!1,color:[.5,.5,1],opacity:.5}),quality:Ve({detail:Ve({value:1,autoAdjust:Ve({enabled:!0,min:-1,max:1}),maxLodTriangles:Number.MAX_SAFE_INTEGER,maxLodTextureBytes:Number.MAX_SAFE_INTEGER}),resolution:Ve({value:1,autoAdjust:Ve({enabled:!0,min:.2,max:1})})}),terrain:Ve({elevationColors:[{elevation:-10,color:[0,0,.5]},{elevation:0,color:[.5,.5,1]},{elevation:0,color:[0,.5,0]},{elevation:10,color:[.5,1,.5]}],asBackground:!1}),advanced:Ve({doubleSided:Ve({opaque:!1,transparent:!1}),hideTerrain:!1,hidePoints:!1,hideTriangles:!1,hideLines:!1}),diagnostics:Ve({maxQueueSize:8,holdDynamic:!1,showBoundingBoxes:!1}),outline:Ve({enable:!1,color:void 0})};class Le{view;camera;renderSettings;statistics;workerView;_gotImage=!1;constructor(e,t,n){this.view=e,this.camera=t,this.renderSettings=n,this.workerView=e.workerView,this.statistics=Re(e.performanceStatistics)}get viewWorldMatrix(){return this.camera?.viewWorldMatrix??E()}get worldViewMatrix(){return this.camera?.worldViewMatrix??E()}get viewClipMatrix(){return this.camera?.viewClipMatrix??E()}get worldClipMatrix(){return this.camera?.worldClipMatrix??E()}async pick(e,t){if(this.camera){const{renderSettings:n}=this,r=n.quality.resolution.value;return await this.workerView.pick(e*r,t*r)}}async measure(e,t){if(this.camera){const{renderSettings:n}=this,r=n.quality.resolution.value;return await this.workerView.measure(e*r,t*r)}}async applyPostEffect(e){return this._gotImage||"ssao"!==e.kind||(this.view.usedSSAO=!0),await this.workerView.applyPostEffect(e)}async getImage(){const e=await this.workerView.getOutputImage();return this._gotImage=!0,e}dispose(){}get hasViewChanged(){const{view:e,renderSettings:t,camera:n}=this,r=t.generation!=e.settings.generation||e._TB.active&&t.quality.detail.autoAdjust.enabled||e._autoFps.active&&t.quality.resolution.autoAdjust.enabled||(n?.generation??0)!=e.camera.generation||e.scene?.generation!==e.prevGens.scene||e.camera.hasChanged||!e.performanceStatistics.sceneResolved||e.workerViewHasPendingChanges;return r||e.dropTime(),r}}k(Array);class He{api;workerView;_scene;_sceneViewState;_renderViewInitialized=Promise.resolve();_modelWorldMatrix=E();_noupdates=!1;_TB;_autoFps;disposed=!1;camera;settings=function(){const e=Object.create(null);return e.generation=0,new De((()=>{e.generation++}),e).wrap(Ie),e}();performanceStatistics={cpuTime:{animation:0,render:{draw:0,update:0,total:0},geometry:{update:0}},triangles:0,points:0,drawCalls:0,sceneResolved:!1,renderResolved:!1,weakDevice:!0,cameraGeneration:0};autoRender=!0;workerViewHasPendingChanges=!1;generation=0;prevGens={camera:0,settings:0,scene:0};constructor(e,t,n){this.api=e,this.workerView=t,n&&this.applySettings(n),this.camera=new we(this),this._TB=new Ee(this,e.deviceProfile),this._autoFps=new Ce(this);const r=b((e=>{this.workerViewHasPendingChanges=e}));t.setPendingChangesCallback(r)}isRenderResolvedChecking=!1;isSceneResolvedChecking=!1;checkRenderResolved(){this.performanceStatistics.renderResolved||this.isRenderResolvedChecking||(this.isRenderResolvedChecking=!0,this.workerView.fullyResolved.then((e=>{this.performanceStatistics.renderResolved=!0})).catch().finally((()=>{this.isRenderResolvedChecking=!1})))}checkSceneResolved(){this.performanceStatistics.sceneResolved||this.isSceneResolvedChecking||!this._sceneViewState||(this.isSceneResolvedChecking=!0,this._sceneViewState.fullyResolved.then((e=>{this.performanceStatistics.sceneResolved=!0})).catch().finally((()=>{this.isSceneResolvedChecking=!1})))}applySettings(e){const{settings:t}=this;e.quality?.resolution?.autoAdjust.max&&(e.quality.resolution.autoAdjust.max=this.api.deviceProfile.renderFullResolution?1:1/devicePixelRatio,e.quality.resolution.value>e.quality.resolution.autoAdjust.max&&(e.quality.resolution.value=e.quality.resolution.autoAdjust.max)),t.generation,_e(t,e)}async setScene(e){if(this._scene=e,e){const{config:r}=e;t=this._modelWorldMatrix,n=r.modelWorldMatrix??E(),t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]}else C(this._modelWorldMatrix);var t,n;this._sceneViewState&&(await this._sceneViewState.dispose(),this._sceneViewState=void 0),e&&(this._sceneViewState=await e.createViewState(this.workerView,this.api.deviceProfile),this.performanceStatistics.sceneResolved=!1,this.performanceStatistics.renderResolved=!1,this.isRenderResolvedChecking=!1,this.isSceneResolvedChecking=!1,this.checkSceneResolved(),this._TB=new Ee(this,this.api.deviceProfile),this._autoFps=new Ce(this))}get scene(){return this._scene}set scene(e){this._scene!=e&&(this._renderViewInitialized=this.setScene(e))}async dispose(){this.disposed||(this.disposed=!0,this._sceneViewState&&await this._sceneViewState.dispose(),this.workerView&&(await this.workerView.dispose(),this.workerView[a]()))}computeCameraValues(){const{camera:e,settings:t}=this;if(e){const n=t.quality.resolution.value;let{width:r,height:i}=t.display;r*=n,i*=n;const a=r/i,{generation:o,viewFrustum:s,viewClipMatrix:l,viewWorldMatrix:c}=e.update(a);return function(e,t,n,r,i,a,o,s){const l=new Se(e,t,n);return function(e,t,n){var r,i;(r=Te)[0]=(i=t)[12],r[1]=i[13],r[2]=i[14];const{left:a,right:o,top:s,bottom:l,near:c,far:d,image:h}=e,u=[a,o,s,l,c,d,h];for(const m of u){const[e,t,r,i]=m;H(Me,e,t,r),K(Me,Me,n);const a=i+F(Te,Me);ee(m,Me[0],Me[1],Me[2],-a)}}(r,l.getMatrix(xe.View,xe.Model),l.getMatrixNormal(xe.View,xe.Model)),{generation:i,viewFrustum:r,width:a,height:o,...Pe(l),...je(l),projection:s}}(this._modelWorldMatrix,c,l,s,o,r,i,e.kind)}}update(){const{camera:e}=this;if(e){const{controller:t}=e;if(void 0!==t){const n=performance.now();t.update(e,this._scene?.boundingSphere,.001*(n-this.controllerLastTime)),this.controllerLastTime=n}}}lastRenderStartTime=0;usedSSAO=!1;dropTime(){this.lastRenderStartTime=0}async render(e){const{camera:t,performanceStatistics:n,prevGens:r}=this;for(;;){const{sceneResolved:i}=n;if(await this.api.waitFrame(),this.update(),t&&(r.camera!==t.generation||t.hasChanged)||r.settings!==this.settings.generation||r.scene!==this._scene?.generation||this._TB.active&&this.settings.quality.detail.autoAdjust.enabled||this._autoFps.active&&this.settings.quality.resolution.autoAdjust.enabled||!i||this.workerViewHasPendingChanges){r.camera=t.generation,r.settings=this.settings.generation,r.scene=this._scene?.generation??0;break}this.lastRenderStartTime=0,e&&e()}const i=this.computeCameraValues(),a=function(e){return Re(e)}(this.settings),{holdDynamic:o}=a.diagnostics;if(i&&!o){const e=this._sceneViewState;if(e){const t=await e.update(i,a);n.cpuTime.geometry.update=t.updateTime,n.sceneResolved=t.resolved}}const{width:s,height:l}=a.display;await this._renderViewInitialized;const{workerView:c}=this;this._autoFps.setSize(s,l,a);const d=performance.now();if(this.lastRenderStartTime>0){const e=d-this.lastRenderStartTime;this.performanceStatistics.cpuTime.render.total=e;const t=this.lastGeneration!==n.cameraGeneration;t&&(this.lastMoveTime=d);const r=d-this.lastMoveTime<1e3;this.lastGeneration=n.cameraGeneration,this._autoFps.active&&this._autoFps.isInitializing||this._TB.update(e,this.performanceStatistics,t),this._autoFps.update(e,this.performanceStatistics,t,r,this.usedSSAO)}else this.performanceStatistics.cpuTime.render.total=0;this.lastRenderStartTime=d,this.usedSSAO=!1;const h=await c.render(i,a,this.generation++);return n.cpuTime.render.draw=h.drawTime,n.cpuTime.render.update=h.updateTime,n.drawCalls=h.drawcalls,n.triangles=h.triangles,n.points=h.points,n.cameraGeneration=i?.generation??0,this.checkSceneResolved(),this.checkRenderResolved(),new Le(this,i,a)}lastMoveTime=0;controllerLastTime=0;lastGeneration=0;get fullyResolved(){return(async()=>{await this.workerView.fullyResolved,await this.api.waitFrame()})()}async transferToImageBitmap(){return await this.workerView.transferToImageBitmap()}async convertToBlob(e){return await this.workerView.convertToBlob(e)}async updatePickBuffers(){if(this.computeCameraValues()){const{settings:e}=this;e.quality.resolution.value,await this.workerView.updatePickBuffers()}}async pick(e,t){if(this.computeCameraValues()){const{settings:n}=this,r=n.quality.resolution.value;return await this.workerView.pick(e*r,t*r)}}async measure(e,t){if(this.computeCameraValues()){const{settings:n}=this,r=n.quality.resolution.value;return await this.workerView.measure(e*r,t*r)}}}const Ne={cube:[new class{id;name;path;type;constructor(e,t,n,r){this.id=e,this.name=t,this.path=n,this.type=r}description;url;properties=[];loadMetaData(){return Promise.resolve(this)}save(){return Promise.resolve(!1)}}(0,"cube","cube",1)]},Be={empty:{kind:"empty",id:"empty",version:"",boundingSphere:{center:D(),radius:1},modelWorldMatrix:E(),materials:[],db:"empty"},cube:{kind:"cube",id:"cube",version:"",count:1,radius:0,boundingSphere:{center:D(),radius:0+Math.sqrt(3)},modelWorldMatrix:E(),materials:[{kind:"basic_z",uniforms:{color:I(1,0,0)}},{kind:"basic_z",uniforms:{color:I(1,1,0)}},{kind:"basic_z",uniforms:{color:I(0,1,0)}},{kind:"basic_z",uniforms:{color:I(0,1,1)}},{kind:"basic_z",uniforms:{color:I(0,0,1)}},{kind:"basic_z",uniforms:{color:I(1,0,1)}}],db:"cube"}};function ze(e,t){const n=("string"==typeof t?[t]:t).map((e=>new RegExp(e,"i")));if(n.some((t=>t.test(e.name))))return!0;const{path:r}=e,i=r.split("/");if(n.some((e=>e.test(i[i.length-1])))||e.description&&n.some((t=>t.test(e.description))))return!0;const{properties:a}=e;if(void 0!==a)for(let o of a)if(n.some((e=>e.test(o[0])))||n.some((e=>e.test(o[1]))))return!0;return!1}function Ue(e,t){if(e.name===t)return!0;const{path:n}=e,r=n.split("/");if(r[r.length-1]===t||e.description===t)return!0;const{properties:i}=e;if(void 0!==i)for(let a of i)if(a[0]===t||a[1]===t)return!0;return!1}async function*We(e,t){let n=t.parentPath??"",r=0,i=t.descentDepth??1e5;if(n.length>0)r=n.split("/").length-1,i>0?(n+="/",i+=r,e=e.filter((e=>e.level>r&&e.level<=i&&e.path.startsWith(n)))):e=e.filter((e=>e.level===r&&e.path===n));else{if(0===i)return;e=e.filter((e=>e.level<i))}const{searchPattern:a}=t;if(a)if(Array.isArray(a)){for(const{property:o,value:s,exact:l}of a)if(void 0!==s)if(o)if(l)e=e.filter((e=>{for(const t of e.properties)if(t[0]===o&&t[1]===s)return!0;return!1}));else{const t=new RegExp(o,"i"),n=("string"==typeof s?[s]:s).map((e=>new RegExp(e,"i")));e=e.filter((e=>{for(const r of e.properties)if(t.test(r[0])&&n.some((e=>e.test(r[1]))))return!0;return!1}))}else e=l?e.filter((e=>Ue(e,s))):e.filter((e=>ze(e,s)))}else e=e.filter((e=>ze(e,a)));yield*e.sort(((e,t)=>(0===e.type?-2:0)+(0===t.type?2:0)+(e.path>t.path?1:-1)))}class Fe{db;loadMetaData(){return Promise.resolve(this)}save(){return Promise.resolve(!1)}constructor(e){this.db=e,e.forEach(((e,t)=>{e.loadMetaData=this.loadMetaData,e.save=this.save}))}search(e,t){return We(this.db,e)}getObjectMetdata(e){return Promise.resolve(this.db[e])}}async function*qe(e,t){const n=await fetch(e.toString(),{signal:t});if(!n.ok)throw new Error(`Failed to retreive scene metadata: ${n.status} ${n.statusText}`);if(n.body){const e=n.body.getReader(),t=new TextDecoder("utf-8");let{value:r,done:i}=await e.read(),a=r?t.decode(r):"",o=/\r\n|\n|\r/gm,s=0;for(;;){let n=o.exec(a);if(n)yield a.substring(s,n.index),s=o.lastIndex;else{if(i)break;let n=a.substr(s);({value:r,done:i}=await e.read()),a=n+(r?t.decode(r):""),s=o.lastIndex=0}}s<a.length&&(yield a.substr(s))}}class Ge{url;loadMetaData(){return Promise.resolve(this)}save(){return Promise.resolve(!1)}_promise;constructor(e){this.url=e}async getDB(e){if(!this._promise){const t=new URL(this.url);t.pathname+="metadata",this._promise=async function(e,t,n,r){let i=[];const a=qe(e,r);for await(const o of a){const e=JSON.parse(o);e.loadMetaData=t,e.save=n,i.push(e)}return i}(t,this.loadMetaData,this.save,e)}return this._promise}search(e,t){return async function*(e,t){const n=await e;for await(const r of We(n,t))yield r}(this.getDB(t),e)}async getObjectMetdata(e){return(await this.getDB())[e]}}class Ke{objectHighlightIndices;generation=0;constructor(e){this.objectHighlightIndices=new Uint8Array(e)}async commit(){this.generation++}}!function(e){e.empty=new e(0)}(Ke||(Ke={}));class Ye{assetUrl;config;db;workerAssets;createWorkerScene;title="";dateCreated=new Date(Date.now());dateLastSaved=new Date(Date.now());description="";location;timezone;_highlighter;instances=[];boundingSphere;id;get subtrees(){return this.config.subtrees}get variants(){return this.config.variants}_generation=0;get generation(){return this._generation}constructor(e,t,n,r,i){this.assetUrl=e,this.config=t,this.db=n,this.workerAssets=r,this.createWorkerScene=i,this.id=t.id;const{center:a,radius:o}=t.boundingSphere,s=I(1,1,1);t.modelWorldMatrix&&(_(s,t.modelWorldMatrix),G(a,a,t.modelWorldMatrix)),this.boundingSphere={center:a,radius:o*s[0]}}async createViewState(e,t){const{config:n,assetUrl:r}=this,a=await this.createWorkerScene(),o=await e[i](),s=await a.initialize(g(o,[o]),t,n,r);return s&&(L(this.boundingSphere.center,s.center),this.boundingSphere.radius=s.radius),new Ye.ViewState(this,a)}get dynamicObjects(){const{instances:e}=this;return function*(){for(let t of e)t&&(yield t)}()}getObjectReference(e){return{id:e,loadMetaData:()=>this.db.getObjectMetdata(e)}}search(e,t){return this.db.search(e,t)}async descendants(e,t){if(!e.descendants)try{const n=new URL(this.assetUrl);n.pathname+=`descendants/${e.id}`;const r=[],i=qe(n,t);for await(const e of i)r.push(parseInt(e));e.descendants=r}catch{e.descendants=[]}return e.descendants??[]}computeSunPosition(e){if(!this.location)return{azimuth:0,inclination:0};function t(e){return Math.sin(e*Math.PI/180)}function n(e){return 180*Math.asin(e)/Math.PI}function r(e){return Math.cos(e*Math.PI/180)}function i(e){return 180*Math.acos(Math.max(-1,Math.min(1,e)))/Math.PI}const a=Math.floor((e.getTime()-new Date(e.getFullYear(),0,1).getTime())/864e5),o=e.getHours()+e.getMinutes()/60+this.location.longitude/15-(this.timezone??0),s=15*o-90,l=-n(.39779*r(.98565*(a+10)+1.914*t(.98565*(a-2)))),c=n(t(this.location.latitude)*t(l)+t(s)*r(this.location.latitude)*r(l));let d;return d=this.location.latitude<90&&this.location.latitude>-90?i((t(l)-r(90-c)*t(this.location.latitude))/(t(90-c)*r(this.location.latitude))):i(r(15*o)*r(l)/t(90-c)),{azimuth:o>12||o<0?360-d:d,inclination:c}}createDynamicObject(e){const{instances:t}=this,n=t.length,r=new Ze(e,(()=>{this._generation++}),(()=>{t[n]=void 0}));return t[n]=r,r}get objectHighlighter(){if(!this._highlighter){const{config:e}=this;function t(e){return"octree"==e.kind}if(!t(e))return Ke.empty;{const{numObjects:n}=e;this._highlighter=new Ke(n)}}return this._highlighter}}(Ye||(Ye={})).ViewState=class{scene;workerScene;_prevHighlighterGeneration=-1;_prevObjectHighlights;constructor(e,t){this.scene=e,this.workerScene=t,this._prevObjectHighlights=Ie.objectHighlights}async dispose(){await this.workerScene.dispose(),this.workerScene[a]()}async update(e,t){const n=this.scene.instances.map((e=>{if(e){const{visible:t,position:n,rotation:r,scale:i,geometry:a}=e;return{assetId:a.id,visible:t,position:n,rotation:r,scale:i}}})),r=this.scene._highlighter;let i;if(r&&this._prevHighlighterGeneration!=r.generation&&(this._prevHighlighterGeneration=r.generation,i=r.objectHighlightIndices.buffer),this._prevObjectHighlights!=t.objectHighlights)this._prevObjectHighlights=t.objectHighlights;else{const{objectHighlights:e,...n}=t;t=n}return await this.workerScene.update(e,n,i,t)}get fullyResolved(){return(async()=>{await this.workerScene.fullyResolved})()}};class Ze{geometry;updated;remove;_visible=!1;_position=D();_rotation=ne();_scale=I(1,1,1);get visible(){return this._visible}get position(){return this._position}get rotation(){return this._rotation}get scale(){return this._scale}set visible(e){e!==this._visible&&(this._visible=e,this.updated())}set position(e){Z(e,this._position)||(this._position=e,this.updated())}set rotation(e){se(e,this._rotation)||(this._rotation=e,this.updated())}set scale(e){Z(e,this._scale)||(this._scale=e,this.updated())}constructor(e,t,n){this.geometry=e,this.updated=t,this.remove=n}dispose(){this.remove()}}function Xe(e,t){return!(!e&&t||e&&!t||e&&t&&(e.pathIndex!=t.pathIndex||e.pathKind!=t.pathKind))}function $e(e,t,n){const{camera:r}=e,i=A(E(),r.rotation,r.position);return O(i,i),{camMat:i,projMat:V(E(),T(r.fieldOfView),t/n,r.near,r.far)}}function Qe(e,t,n,r,i,a){const o=e=>{const t=te(Q(),J(e[0],e[1],e[2],1),n);return ce((.5*t[0]/t[3]+.5)*i,(.5-.5*t[1]/t[3])*a)},s=(e,t)=>{const n=X(D(),t,e);return z(n,n,(-r-e[2])/n[2]),N(n,n,e)},l=[],c=e.map((e=>G(D(),e,t)));return[c.reduce(((e,t,n)=>{if(t[2]>0){if(0===n||c[n-1][2]>0)return e;const r=s(c[n-1],t),i=o(r);return l.push(i),e.concat([i])}const r=o(t);if(l.push(r),0!==n&&c[n-1][2]>0){const i=s(t,c[n-1]),a=o(i);return e.concat([a],[r])}return e.concat([r])}),[]),l]}k(Array);class Je{id;getPaths;getEntitiyDrawObjects;_renderOutput;facePaths=[];edgePaths=[];currentDir=D();viewDirMatrix=E();selected;highlighted;dirty=!0;constructor(e,t,n,r){this.id=e,this.getPaths=t,this.getEntitiyDrawObjects=n,this.selected=r}get selectedEntity(){if(this.selected)return this.createMeasureEntity(this.selected)}get productId(){return this.id}async renderMeasureEntity(e,t,n){const r=this.selectedEntity;if(r){const{camera:i}=e;if("pinhole"==i.kind){const{camMat:a,projMat:o}=$e(e,t,n),s=await this.getEntitiyDrawObjects(r),l=[];for(const e of s){const[r]=Qe(e.vertices,a,o,i.near,t,n);l.push({vertices:r,drawType:e.drawType})}return l}}}createMeasureEntity(e){const t=e.pathKind;return{...e,objectId:this.id,kind:t}}set renderOutput(e){const t=e;if(t!=this._renderOutput)if(this._renderOutput=t,e){const t=function(e){const t=J(0,0,1,0);return te(t,t,e),I(t[0],t[1],t[2])}(e.viewWorldMatrix);F(t,this.currentDir)<.99999999&&(this.currentDir=t,function(e,t,n,r){var i,a,o,s,l,c,d,h,u,m,p=t[0],f=t[1],g=t[2],b=r[0],v=r[1],y=r[2],w=n[0],x=n[1],k=n[2];Math.abs(p-w)<1e-6&&Math.abs(f-x)<1e-6&&Math.abs(g-k)<1e-6?C(e):(d=p-w,h=f-x,u=g-k,i=v*(u*=m=1/Math.hypot(d,h,u))-y*(h*=m),a=y*(d*=m)-b*u,o=b*h-v*d,(m=Math.hypot(i,a,o))?(i*=m=1/m,a*=m,o*=m):(i=0,a=0,o=0),s=h*o-u*a,l=u*i-d*o,c=d*a-h*i,(m=Math.hypot(s,l,c))?(s*=m=1/m,l*=m,c*=m):(s=0,l=0,c=0),e[0]=i,e[1]=s,e[2]=d,e[3]=0,e[4]=a,e[5]=l,e[6]=h,e[7]=0,e[8]=o,e[9]=c,e[10]=u,e[11]=0,e[12]=-(i*p+a*f+o*g),e[13]=-(s*p+l*f+c*g),e[14]=-(d*p+h*f+u*g),e[15]=1)}(this.viewDirMatrix,t,D(),I(0,1,0)),this.getPaths(this.viewDirMatrix).then((e=>{this.facePaths=e.filter((e=>"face"==e.kind)),this.edgePaths=e.filter((e=>"edge"==e.kind))})))}else this.facePaths=[],this.edgePaths=[]}contextTransform(e,t,n,r){const i=t/2,a=n/2,o=r.viewClipMatrix[5]*a;var s=(1+r.worldClipMatrix[12])*i,l=(1-r.worldClipMatrix[13])*a;const c=new DOMMatrix([o,0,0,-o,s,l]);e.setTransform(c),e.lineWidth=2/o}renderPoints(e,t,n,r){if(this._renderOutput){const i=this._renderOutput;this.contextTransform(e,t,n,i);const a=i.viewClipMatrix[5]*n/2,{viewDirMatrix:o}=this,s=5/a;e.fillStyle="red";for(const t of r){const n=G(D(),t,o),[r,i]=n;e.beginPath(),e.ellipse(r,i,s,s,0,0,2*Math.PI),e.fill()}e.resetTransform()}}renderPaths(e,t,n){const{facePaths:r,edgePaths:i}=this,{pathIndex:a,pathKind:o}=this.highlighted??{},{pathIndex:s,pathKind:l}=this.selected??{};if(this._renderOutput){this.contextTransform(e,t,n,this._renderOutput);for(const t of r){const{path:n,originalIndex:r}=t;e.fillStyle="face"==o&&r===a?"yellow":"face"==l&&r===s?"green":"darkgray",e.fill(n),e.strokeStyle="white",e.stroke(n)}for(const t of i){const{path:n,originalIndex:r}=t;e.strokeStyle="edge"==o&&r===a?"yellow":"edge"==l&&r===s?"green":"black",e.stroke(n)}e.resetTransform()}this.dirty=!1}hover(e,t,n,r,i){const a=this.pickPath(e,t,n,r,i);return!Xe(this.highlighted,a)&&(this.highlighted=a,this.dirty=!0,!0)}select(){return!(Xe(this.highlighted,this.selected)||!this.highlighted||(this.selected=this.highlighted,this.dirty=!0,0))}pickPath(e,t,n,r,i){if(this._renderOutput){this.contextTransform(e,r,i,this._renderOutput);const{facePaths:a,edgePaths:o}=this;for(let r=o.length-1;r>=0;--r){const i=o[r],{path:a}=i;if(e.isPointInStroke(a,t,n))return{pathKind:"edge",pathIndex:i.originalIndex,instanceIndex:i.instanceIndex,parameter:0}}for(let r=a.length-1;r>=0;--r){const i=a[r],{path:o}=i;if(e.isPointInPath(o,t,n))return{pathKind:"face",pathIndex:i.originalIndex,instanceIndex:i.instanceIndex,parameter:0}}}e.resetTransform()}}k(Array);class et{assetUrl;measureService;workerScene;constructor(e,t){this.assetUrl=e,this.measureService=t,e.pathname+="brep/",this.workerScene=this.measureService.createMeasureTool(e.toString())}async measurePair(e,t,n,r){if("vertex"==e.kind)return"vertex"==t.kind?this.pointToPoint(e.parameter,t.parameter):this.measureToPoint(t,e.parameter,r);if("vertex"==t.kind)return this.measureToPoint(e,t.parameter,n);const i=await this.workerScene,a=[{object:e,settings:n},{object:t,settings:r}];a.sort(((e,t)=>e.object.pathKind.localeCompare(t.object.pathKind)));const[o,s]=a;switch(`${o.object.pathKind}_${s.object.pathKind}`){case"edge_edge":return await i.edgeToEdgeMeasure(e.objectId,e.pathIndex,e.instanceIndex,t.objectId,t.pathIndex,t.instanceIndex);case"edge_face":return await i.edgeToFaceMeasure(e.objectId,e.pathIndex,e.instanceIndex,t.objectId,t.pathIndex,t.instanceIndex,s.settings);case"face_face":return await i.faceToFaceMeasure(e.objectId,e.pathIndex,e.instanceIndex,t.objectId,t.pathIndex,t.instanceIndex,o.settings,s.settings)}}async measureSingle(e,t){const n=await this.workerScene;switch(e.kind){case"edge":function r(){}return{...await n.getEdgeValues(e.objectId,e.pathIndex,e.instanceIndex),render:r};case"face":return await n.getFaceValues(e.objectId,e.pathIndex,e.instanceIndex)}}async measure(e,t,n,r){return t?this.measurePair(e,t,n,r):this.measureSingle(e,n)}async measureToPoint(e,t,n){if("vertex"==e.kind)return this.pointToPoint(e.parameter,t);const r=await this.workerScene;return"face"==e.kind?await r.faceToPointMeasure(e.objectId,e.pathIndex,e.instanceIndex,t,n):await r.edgeToPointMeasure(e.objectId,e.pathIndex,e.instanceIndex,t)}pointToPoint(e,t){const n=X(D(),e,t);return{distance:$(n),distanceX:Math.abs(n[0]),distanceY:Math.abs(n[1]),distanceZ:Math.abs(n[2]),pointA:e,pointB:t}}async getCameraValues(e,t){return(await this.workerScene).getCameraValuesFromFace(e.objectId,e.pathIndex,e.instanceIndex,t)}async downloadMeasureObject(e,t){const n=await this.workerScene,r=await n.pickEntity(e,t);return new Je(e,(async function(t){return(await n.getPaths(e,t)).map((e=>({path:new Path2D(e.path),originalIndex:e.originalIndex,kind:e.kind,instanceIndex:e.instanceIndex})))}),(async function(e){switch(e.kind){case"edge":return[{vertices:await n.getTesselatedEdge(e.objectId,e.pathIndex,e.instanceIndex),drawType:"lines"}];case"face":return await n.getFaceDrawObject(e.objectId,e.pathIndex,e.instanceIndex);case"vertex":return[{vertices:[e.parameter],drawType:"vertex"}]}}),r)}tmpCaluculateDir(e,t){const n=X(D(),e,t);return W(n,n),n}}const tt=document.currentScript?.src??"file:///media/Datas/novorender/webgl-api-doc-test/node_modules/@novorender/webgl-api/index.js";class nt{scriptUrl;workers;constructor(){const e=new URL(tt);this.scriptUrl=new URL("./",e).href.slice(0,-1)}async createWorkers(){const e=((e,t)=>{if(this.scriptUrl.startsWith(self.location.origin))return new Worker(e,{type:"classic",name:t});{const n=new Blob([`importScripts(${JSON.stringify(e)});`],{type:"text/javascript"}),r=URL.createObjectURL(n),i=new Worker(r,{type:"classic",name:t});return URL.revokeObjectURL(r),i}})(`${this.scriptUrl}/measure.js`,"Measure"),t=h(e);this.workers={measure:{worker:e,service:t}},t.initialize(this.scriptUrl)}async loadScene(e){return this.workers||await this.createWorkers(),"string"==typeof e&&(e=new URL(e.toString())),new et(e,this.workers.measure.service)}async dispose(){const{workers:e}=this;if(e){const{measure:t}=e;await t.service.terminate(),t.service[a](),this.workers=void 0}}toPathPoints(e,t,n,r){const{camera:i}=t,{camMat:a,projMat:o}=$e(t,n,r);return Qe(e,a,o,i.near,n,r)}}const rt=document.currentScript?.src??"file:///media/Datas/novorender/webgl-api-doc-test/node_modules/@novorender/webgl-api/index.js";async function it(e){const t=new Image;t.crossOrigin="anonymous";const n=new Promise(((n,r)=>{t.addEventListener("load",(()=>{const e=document.createElement("canvas"),{width:r,height:i}=t;e.width=r,e.height=i;const a=e.getContext("2d",{alpha:!0,desynchronized:!1});a.drawImage(t,0,0);const o=a.getImageData(0,0,r,i);n(o)}),!1),t.addEventListener("error",(()=>{r(`Failed to download image: ${e}`)}))}));return t.src=e,n}function at(e){let t=1,n=0;return function(e){return"object"==typeof e}(e)?(e.scale&&(t=e.scale),e.offset&&(n=e.offset)):"number"==typeof e&&(t=0,n=e),[t,n]}class ot{url;id;boundingSphere;remove;constructor(e,t,n,r){this.url=e,this.id=t,this.boundingSphere=n,this.remove=r}dispose(){this.remove()}}class st{assetsUrl;webGL1Only;version;scriptUrl;run=!0;animate;supportsOffscreenCanvas="OffscreenCanvas"in self;animHandle;dynamicAssets=[];environments=[];views=new Oe;workerAssets;deviceProfile;workers;constructor(e,t,n){this.assetsUrl=e,this.webGL1Only=t;const r=new URL(rt);this.scriptUrl=new URL("./",r).href.slice(0,-1),this.version="0.3.81",n&&(this.supportsOffscreenCanvas=!1),this.deviceProfile=function(){const e=document.createElement("CANVAS");e.width=1,e.height=1,document.body.appendChild(e);const t=e.getContext("webgl",{failIfMajorPerformanceCaveat:!0});e.remove();let n="unknown",r=!1,i=null==t,a=!1,o=.25,s=40,l=.25,c=5e6,d=5e6;const h=t?.getExtension("WEBGL_debug_renderer_info"),u=h?t?.getParameter(37446):"???",{userAgent:m}=navigator,p=/\bMobile\b/.test(m);return/\bWindows\b/.test(m)?(n="windows",i||(o=1,a=!1,c=2e7,d=1e7,s=50,l=1,/\bNVIDIA|Radeon\b/.test(u)&&(r=!0,a=!0,c=2e7,d=5e7,l=1.5))):/\bMacintosh\b/.test(m)?p?i||(n="ipad",s=40,o=.5,a=!1,l=.5,c=5e6,d=5e6):(n="mac",i||(s=50,o=1,a=!1,l=1,c=2e7,d=1e7)):/\biPad/.test(m)?(n="ipad",i||(s=40,o=.5,a=!1,l=.5,c=5e6,d=5e6)):/\biPhone/.test(m)?n="ios":/\bbAndroid\b/.test(m)&&(n="android",p||i||(s=40,o=.5,a=!1,l=.5,c=5e6,d=5e6)),{name:n,hasMajorPerformanceCaveat:i,discreteGPU:r,targetFPS:s,detailBias:l,renderFullResolution:a,textureResolution:o,triangleLimit:c,textureBytesLimit:d}}()}async createWorkers(){const e=(e,t)=>{if(this.scriptUrl.startsWith(self.location.origin))return new Worker(e,{type:"classic",name:t});{const n=new Blob([`importScripts(${JSON.stringify(e)});`],{type:"text/javascript"}),r=URL.createObjectURL(n),i=new Worker(r,{type:"classic",name:t});return URL.revokeObjectURL(r),i}},t=this.supportsOffscreenCanvas?e(`${this.scriptUrl}/render.js`,"Render"):(e=>{const{port1:t,port2:r}=new MessageChannel;return n(89351)(e).then((e=>{const{__initRenderServiceEndPoint__:t}=self;t(r),delete self.__initRenderServiceEndPoint__}),(e=>{throw new e})),t})(`${this.scriptUrl}/render.js`),r=e(`${this.scriptUrl}/geometry.js`,"Geometry"),i=h(t),a=h(r);this.workers={render:{worker:t,service:i},geometry:{worker:r,service:a}};const o=await i.materialTypes;this.workerAssets=await a.initialize(o,this.scriptUrl,this.supportsOffscreenCanvas?void 0:b(it)),this.animHandle=requestAnimationFrame(this.animateCB)}async dispose(){this.run=!1,this.animHandle&&(cancelAnimationFrame(this.animHandle),this.animHandle=void 0);for(const t of this.views)await t.dispose();const{workers:e}=this;if(e){const{render:t,geometry:n}=e;await n.service.terminate(),await t.service.terminate(),n.service[a](),t.service[a](),this.workers=void 0}}resolves=[];animateCB=async e=>{this.run&&(this.animate?.(e),this.internalUpdate());for(const t of this.resolves)t(void 0);this.resolves.length=0,this.animHandle=requestAnimationFrame(this.animateCB)};async waitFrame(){const e=new Promise((e=>{this.resolves.push(e)}));await e}internalUpdate(){const e=[];for(const t of this.views)t.disposed?e.push(t):t.update();for(const t of e)this.views.remove(t)}async update(){await this.internalUpdate(),await this.waitFrame()}async loadScene(e,t){return this.workers||await this.createWorkers(),"string"!=typeof e&&(e=e.toString()),async function(e,t,n){let r=Be[t];if(r)t=location.origin;else{const e=new URL(t);e.pathname+="config.json",r=await async function(e){const t=await fetch(e);if(!t.ok)throw new Error(t.statusText);return await t.json()}(e.toString())}const i=Ne[r.id],a=n??(i?new Fe(i):new Ge(t)),{assets:o,createScene:s}=await e.createAssets(t);return new Ye(t,r,a,o,s)}(this.workers.geometry.service,e,t)}async loadAsset(e){this.workers||await this.createWorkers();const{dynamicAssets:t,workerAssets:n}=this,r=t.length;t[r]=void 0;const i=await n.loadAsset(r,e.toString());return t[r]=new ot(e,r,i,(async()=>{await n.disposeAsset(r),t[r]=void 0}))}async loadEnvironment(e){this.workers||await this.createWorkers();const{environments:t,workerAssets:n}=this,r=t.length;return t[r]=void 0,await n.loadEnvironment(r,e.url),t[r]={id:r,dispose:async()=>{await n.disposeEnvironment(r),t[r]=void 0}}}async createView(e,t){this.workers||await this.createWorkers();const n=await async function(e,t,n,r,i){const a=n?.quality?.resolution.value??1,o=n?.display?.width??300*a,s=n?.display?.height??150*a;self.__htmlRenderCanvas__=i;const l=await t.createView(o,s,r);return delete self.__htmlRenderCanvas__,new He(e,l,n)}(this,this.workers.render.service,e,this.webGL1Only,t);return this.views.add(n),n}createNeutralHighlight(){return{rgbaTransform:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]}}createTransparentHighlight(e){return{rgbaTransform:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,e,0]}}createColorSetHighlight(e){const[t,n,r,i]=e;return{rgbaTransform:[0,0,0,0,t,0,0,0,0,n,0,0,0,0,r,0,0,0,0,i??1]}}createRGBATransformHighlight(e){const t=at(e.red),n=at(e.green),r=at(e.blue),i=at(e.opacity);return{rgbaTransform:[t[0],0,0,0,t[1],0,n[0],0,0,n[1],0,0,r[0],0,r[1],0,0,0,i[0],i[1]]}}createHSLATransformHighlight(e){const[t,n]=at(e.lightness),[r,i]=at(e.opacity);function a(e,t,n){return e+(t-e)*n}const o=e.saturation??1,s=a(1/3,1,o)*t,l=a(1/3,0,o)*t;return{rgbaTransform:[s,l,l,0,n,l,s,l,0,n,l,l,s,0,n,0,0,0,r,i]}}createHighlight(e){switch(e.kind){case"neutral":return this.createNeutralHighlight();case"transparent":return this.createTransparentHighlight(e.opacity);case"color":return this.createColorSetHighlight(e.color);case"rgba":return this.createRGBATransformHighlight(e);case"hsla":return this.createHSLATransformHighlight(e);default:{function t(e){throw new Error("Unknown highlight type {$params.kind}!")}return t()}}}createCameraController(e,t){switch(e.kind){case"static":return new fe(e);case"turntable":return new ge(e);case"orbit":return new be(e,t);case"flight":return new ve(e,t);case"ortho":return new ye(e,t);default:{function n(e){throw new Error("Unknown controller type {$params.kind}!")}return n()}}}async availableEnvironments(e){let t=[];const n=new URL(e??"/assets/env/index.json",rt),r=await fetch(n.toString());return r.ok&&(t=(await r.json()).map((e=>({name:e,url:new URL(e,n).toString(),thumnbnailURL:new URL(`thumbnails/${e}.png`,n).toString()})))),t}}function lt(e){return new st(e?.assetsUrl??"https://blobs.novorender.com",e?.webGL1Only??!1,e?.noOffscreenCanvas??!1)}function ct(){return new nt}var dt,ht;!function(e){e.empty="empty",e.cube="cube",e.oilrig="https://blobs.novorender.com/9fb7bdf8ae8445189573681194718db8/",e.condos="https://blobs.novorender.com/1169297611ae33f63132f264ed34e265/"}(dt||(dt={})),function(e){e[e.Internal=0]="Internal",e[e.Leaf=1]="Leaf"}(ht||(ht={}))},91262:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(67294),i=n(72389);function a(e){var t=e.children,n=e.fallback;return(0,i.Z)()?r.createElement(r.Fragment,null,null==t?void 0:t()):null!=n?n:null}},73123:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(67294),i=n(86010),a={note:r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},r.createElement("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})),tip:r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},r.createElement("path",{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})),danger:r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},r.createElement("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"})),info:r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},r.createElement("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})),caution:r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},r.createElement("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))},o={note:"secondary",tip:"success",danger:"danger",info:"info",caution:"warning"};function s(e){var t=e.children,n=e.type,s=e.title,l=void 0===s?n:s,c=e.icon,d=void 0===c?a[n]:c;return r.createElement("div",{className:(0,i.Z)("admonition","admonition-"+n,"alert","alert--"+o[n])},r.createElement("div",{className:"admonition-heading"},r.createElement("h5",null,r.createElement("span",{className:"admonition-icon"},d),l)),r.createElement("div",{className:"admonition-content"},t))}},92899:function(e,t){t.Z='/// <reference types="gl-matrix" />\r\n\r\ndeclare module "@novorender/webgl-api" {\r\n    type AtLeastOne<T, U = { [K in keyof T]: Pick<T, K> }> = Partial<T> & U[keyof U];\r\n\r\n    import type { ReadonlyVec3, ReadonlyVec4, ReadonlyQuat, ReadonlyMat3, vec3, quat, ReadonlyMat4, ReadonlyVec2, vec2 } from "gl-matrix";\r\n\r\n    /** Polyfill for missing/removed API interface.\r\n     * @remarks See https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas/convertToBlob for more details.\r\n     */\r\n    export interface ImageEncodeOptions_ {\r\n        readonly type: string;\r\n        readonly quality: number;\r\n    }\r\n\r\n    /** Color expressed as a 3D vector with ranges [0.0 - 1.0] for red, green and blue components respectively. */\r\n    export type ColorRGB = ReadonlyVec3;\r\n\r\n    /** Color expressed as a 4D vector with ranges [0.0 - 1.0] for red, green, blue and alpha components respectively. */\r\n    export type ColorRGBA = ReadonlyVec4;\r\n\r\n    /** Integer index/handle for identifying a single object */\r\n    export type ObjectId = number; // integer\r\n\r\n    /** Read only array of integer indices/handles for identifying a set of objects */\r\n    export type ObjectIdArray = ReadonlyArray<ObjectId>; // go for Uin32Array instead?\r\n\r\n    /** Fixed size, read-only array type. */\r\n    export type FixedSizeArray<N extends number, T> = N extends 0\r\n        ? never[]\r\n        : {\r\n              0: T;\r\n              length: N;\r\n          } & ReadonlyArray<T>;\r\n\r\n    /** Axis-aligned bounding box */\r\n    export interface AABB {\r\n        /** minimum coordinates */\r\n        readonly min: ReadonlyVec3;\r\n        /** maximum coordinates */\r\n        readonly max: ReadonlyVec3;\r\n    }\r\n\r\n    /** Bounding sphere */\r\n    export interface BoundingSphere {\r\n        /** Sphere center. */\r\n        readonly center: vec3;\r\n        /** Sphere radius. */\r\n        readonly radius: number;\r\n    }\r\n\r\n    /** Geographic coordinate expressed by angles */\r\n    export interface GeoLocation {\r\n        /** Angle ranging from 0\xb0 at the Prime Meridian to +180\xb0 eastward and \u2212180\xb0 westward. */\r\n        longitude: number;\r\n        /** Angle ranging from 0\xb0 at the Equator to +90\xb0 (North pole) and -90\xb0 (South pole). */\r\n        latitude: number;\r\n    }\r\n\r\n    /** Visual highlighting for groups of objects.\r\n     * @remarks\r\n     * This interface is used to highlight or hide sets of objects, based e.g. on interactive selections or queries.\r\n     * Each 3D object in the scene has a unique id/index, which can be assigned to one of the available highlight groups.\r\n     * By default, all objects are assigned to group #0.\r\n     * To change a highlight for a specific object or set of objects, simply change the {@link objectGroups} index for that/this object id(s):\r\n     * `objectHighlights[objectId] = newHighlightGroupIndex`.\r\n     *\r\n     * Highlight index 255/0xff is reserved and used to hide objects.\r\n     * Although you can also hide objects by making them 100% transparent (opacity = 0), assigning them to index 255 is more performant.\r\n     *\r\n     * Changes to object highlights does not become visible until you call the {@link commit} method.\r\n     */\r\n    export interface ObjectHighlighter {\r\n        /** Indexed collection of groups. */\r\n        readonly objectHighlightIndices: Uint8Array; // TODO: Use a generic indexer interface instead?\r\n\r\n        /** Commit changes for rendering. */\r\n        commit(): Promise<void>;\r\n    }\r\n\r\n    /** Linear transform options.\r\n     * @remarks\r\n     * The transform is performed by first applying scale, then adding offset, i.e.: result = value * scale + offset.\r\n     * If scale = 0, offset will effectively replace input value.\r\n     */\r\n    export interface LinearTransform {\r\n        /** Multiplicand for input value. Default = 1.*/\r\n        readonly scale?: number;\r\n        /** Addend for scaled input value. Default = 0. */\r\n        readonly offset?: number;\r\n    }\r\n\r\n    /** Options for RGBA + alpha color transformation.\r\n     * @remarks\r\n     * All input values are between 0 and 1.\r\n     */\r\n    export interface RGBAOptions {\r\n        /** Red color adjustment. */\r\n        readonly red: number | LinearTransform;\r\n        /** Green color adjustment. */\r\n        readonly green: number | LinearTransform;\r\n        /** Blue color adjustment. */\r\n        readonly blue: number | LinearTransform;\r\n        /** Opacity/alpha adjustment. */\r\n        readonly opacity: number | LinearTransform;\r\n    }\r\n\r\n    /** Options for HSL + alpha color transformation.\r\n     * @remarks\r\n     * All input values are between 0 and 1.\r\n     * See [Wikipedia](https://en.wikipedia.org/wiki/HSL_and_HSV) for more details on the HSV color space.\r\n     */\r\n    export interface HSLAOptions {\r\n        /** Lightness adjustment. */\r\n        readonly lightness: number | LinearTransform;\r\n        /** Saturation adjustment (scale). */\r\n        readonly saturation: number;\r\n        // /** Hue adjustment (offset). */\r\n        // readonly hue: number;\r\n        /** Opacity/alpha adjustment. */\r\n        readonly opacity: number | LinearTransform;\r\n    }\r\n\r\n    /** Visual highlighting for a group of objects.\r\n     * @remarks\r\n     * Highlighting is done using a linear transformation matrix per group, which allows for various visual effects in addition to simply assigning a single color.\r\n     * This can be useful to preserve at least some aspects of the original material colors, by, e.g. making certain objects semi-transparent, darker/brighter or color/grayscale.\r\n     */\r\n    export interface Highlight {\r\n        /** 5x4 row-major matrix for color/opacity transform.\r\n         * @remarks\r\n         * This matrix defines the linear transformation that is applied to the original RGBA color before rendering.\r\n         * The fifth column is multiplied by a constant 1, making it useful for translation.\r\n         * The resulting colors are computed thus:\r\n         * ```\r\n         * output_red = r*m[0] + g*m[1] + b*m[2] + a*m[3] + m[4]\r\n         * output_green = r*m[5] + g*m[6] + b*m[7] + a*m[8] + m[9]\r\n         * output_blue = r*m[10] + g*m[11] + b*m[12] + a*m[13] + m[14]\r\n         * output_alpha = r*m[15] + g*m[16] + b*m[17] + a*m[18] + m[19]\r\n         * ```\r\n         * All input values are between 0 and 1 and output value will be clamped to this range.\r\n         * Setting this matrix directly offers the most amount of flexibility.\r\n         */\r\n        rgbaTransform: FixedSizeArray<20, number>;\r\n    }\r\n\r\n    /** Asset data used for dynamic objects.\r\n     * @remarks\r\n     * Dynamic assets represents some combination of 3D geometry, textures, animations, sound and physics data.\r\n     * They can then be introduced into a scene as dynamic objects, allowing multiple instances of each assets.\r\n     * Assets can be imported from an existing file, such as a gltf model.\r\n     */\r\n    export interface DynamicAsset {\r\n        /** The url used for loading data, if any. */\r\n        readonly url?: URL;\r\n\r\n        /** The id assigned to this asset. */\r\n        readonly id: number;\r\n\r\n        /** The bounding sphere of the loaded asset. */\r\n        readonly boundingSphere: BoundingSphere;\r\n\r\n        /** Dispose of asset data.\r\n         * @remarks\r\n         * Disposing of asset data will free up associated system memory.\r\n         * Doing so will make it impossible to create new dynamic objects from this asset.\r\n         * Already created dynamic objects will remain, however, since they are essentially GPU memory copies.\r\n         */\r\n        dispose(): void;\r\n\r\n        // TODO: create assets from scene subset snapshots for e.g. offline rendering.\r\n        // TODO: create/edit programatically for e.g. UI elements.\r\n        // TODO: add export to gltf/whatnot.\r\n    }\r\n\r\n    /** 3D object that can be animated and moved.\r\n     * @remarks\r\n     * Unlike the static geometry of a scene, dynamic objects can be added/removed and moved around after a scene has been created.\r\n     * This functionality comes at a cost, however.\r\n     * Dynamic objects must be fully loaded into client memory before they can be rendered, which restricts their practial use to relatively trivial geometry only.\r\n     * Nor can they take advantage of globally pre-baked information, such as indirect light.\r\n     * They also lack several features of static scene geometry, such as object picking and clipping volumes etc.\r\n     * Dynamic objects can be helpful for 3D UI widgets, background animations of e.g. moving people, cars or animals etc.\r\n     */\r\n    export interface DynamicObject {\r\n        /** The geometry used for rendering. */\r\n        readonly geometry: DynamicAsset;\r\n        /** Whether to render object or not. */\r\n        visible: boolean;\r\n        /** The 3D position of object in world space coordinates. */\r\n        position: ReadonlyVec3;\r\n        /** The 3D orientation of object in world space expressed as a quaternion. */\r\n        rotation: ReadonlyQuat;\r\n        /** The scale of object in local coordinates. */\r\n        scale: ReadonlyVec3;\r\n        /** Remove object from scene and free up any associated resources. */\r\n        dispose(): void;\r\n        // TODO: add animation timer and run/pause mechanism\r\n    }\r\n\r\n    /** Lightweight reference to a single object within a scene instance.\r\n     * @remarks\r\n     * Object metadata are not loaded with scene automatically and may require an additional server request. This interface contains only the identity required to perform such a request.\r\n     */\r\n    export interface ObjectReference {\r\n        /** The id of the object */\r\n        readonly id: ObjectId;\r\n\r\n        /** The instance that contains this object. */\r\n        // readonly instance: Instance;\r\n\r\n        /** Load the associated object meta data. */\r\n        loadMetaData(): Promise<ObjectData>;\r\n    }\r\n\r\n    /** Type of node */\r\n    export const enum NodeType {\r\n        /** Node has children. */\r\n        Internal = 0,\r\n        /** Node has no children. */\r\n        Leaf = 1,\r\n    }\r\n\r\n    /** Hierarcical object reference to a single object within a scene instance.\r\n     *\r\n     * @remarks\r\n     * This interface extends {@link ObjectReference} with data required for hierachical tree views and 3D rendering without loading the entire set of metadata.\r\n     */\r\n    export interface HierarcicalObjectReference extends ObjectReference {\r\n        /** The path of the object expressed as a hierarchical filesystem-like path string. */\r\n        readonly path: string;\r\n\r\n        /** Type of node. */\r\n        readonly type: NodeType;\r\n\r\n        /** Bounding volume */\r\n        readonly bounds?: {\r\n            // readonly box: AABB;\r\n            readonly sphere: BoundingSphere;\r\n        };\r\n        readonly descendants?: ObjectId[];\r\n    }\r\n\r\n    /** Object metadata.\r\n     */\r\n    export interface ObjectData extends HierarcicalObjectReference {\r\n        /** Name of object (typically a GUID from IFC database). */\r\n        readonly name: string;\r\n\r\n        /** Description of object (typically from IFC database). */\r\n        readonly description?: string;\r\n\r\n        /** Url associated with object */\r\n        readonly url?: string;\r\n\r\n        /** String dictionary of any additional metadata properties associated with object */\r\n        properties: [key: string, value: string][];\r\n\r\n        /** Save object meta data. */\r\n        save(): Promise<boolean>;\r\n    }\r\n\r\n    interface CameraProperties {\r\n        /** Camera type. */\r\n        readonly kind: "pinhole" | "orthographic";\r\n        /** Camera position expressed as a world space 3D vector. */\r\n        readonly position: vec3;\r\n        /** Camera orientation expressed as a world space 3D quaternion. */\r\n        readonly rotation: quat;\r\n        /** Field of view expressed as the vertical viewing angle in degrees for pinhole cameras, or vertical aperature dimension in meters for orthographic cameras. */\r\n        fieldOfView: number;\r\n        /** Distance to the view frustum near clipping plane.\r\n         * @remarks\r\n         *  The value must be larger than 0 and preferably as large as possible without creating undesired clipping effects near the camera.\r\n         *  Camera controllers will automatically adjust this value whenever a new scene is assigned to their view, so setting it manually is generally not required.\r\n         *  See {@link https://en.wikipedia.org/wiki/Viewing_frustum} for more details.\r\n         */\r\n        near: number;\r\n        /** Distance to the view frustum far clipping plane.\r\n         * @remarks\r\n         *  The value must be larger than {@link near} and and large enough to include the desired maximum viewing distance, which typically is some multiple of the scene size.\r\n         *  Camera controllers will automatically adjust this value whenever a new scene is assigned to their view, so setting it manually is generally not required.\r\n         *  See {@link https://en.wikipedia.org/wiki/Viewing_frustum} for more details.\r\n         */\r\n        far: number;\r\n    }\r\n\r\n    /** Camera Object. */\r\n    interface Camera extends CameraProperties {\r\n        /** The view to which this camera belongs. */\r\n        readonly view: View;\r\n        /** Get or set the motion controller assigned to this camera. By default, this will be a static controller, whose only function is to provide a reasonable default view for a given scene. */\r\n        controller: CameraController;\r\n        getDistanceFromViewPlane(point: ReadonlyVec3): number;\r\n    }\r\n\r\n    /** Search pattern */\r\n    export interface SearchPattern {\r\n        /** Property name to find. */\r\n        property?: string;\r\n        /** Value to find.\r\n         * if value is array of strings then search property value should match any ("or" function) of array values\r\n         */\r\n        value?: string | string[];\r\n        /** Require exact match or not. */\r\n        exact?: boolean;\r\n        /** Exclude this match from result.\r\n         * property name is mandatory\r\n         */\r\n        exclude?: boolean;\r\n        /** Range of values to search.\r\n         * property name is mandatory\r\n         */\r\n        range?: { min: string; max: string };\r\n    }\r\n\r\n    /** Search object options */\r\n    export interface SearchOptions {\r\n        /** Path to search start from.\r\n         * @remarks\r\n         * Path is similar to filesystem file/folder hierarchical paths, e.g. my_folder/my_object.\r\n         * Paths reflect original CAD model hierarchy (.ifc, .rvm, etc).\r\n         * Only objects contained within specified folder will be returned.\r\n         */\r\n        parentPath?: string;\r\n\r\n        /** How many generations of descendants to include in search.\r\n         * @remarks\r\n         * 0 - object itself\r\n         *\r\n         * 1 - children only\r\n         *\r\n         * undefined - deepest levels.\r\n         */\r\n        descentDepth?: number;\r\n\r\n        /** Property pattern to search for. */\r\n        searchPattern?: SearchPattern[] | string;\r\n\r\n        /** Preload all matching objects.\r\n         * @remarks\r\n         * This param should be set if you want to access some parameters of all results later to prevent per object data request.\r\n         */\r\n        full?: boolean;\r\n    }\r\n\r\n    /** Scene document\r\n     *\r\n     * @remarks\r\n     * A scene represents the document entity of NovoRender, corresponding to something akin to a top level CAD assembly.\r\n     * It provides information for both rendering 3D geometry and querying for object metadata.\r\n     * In order to fascilitate complex datasets on small client devices, scenes load most data on demand and caches a relevant, but still potentially substantial subset in system and GPU memory.\r\n     * Weaker devices may struggle to host multiple scenes in memory at once, so make sure to remove any references to unused scenes and related objects for effective garbage collection when loading new scenes.\r\n     */\r\n    export interface Scene {\r\n        /** Scene Id\r\n         * @remarks\r\n         * For new scenes, this will contain a random string/guid.\r\n         */\r\n        id: string;\r\n\r\n        /** Scene title */\r\n        title: string;\r\n\r\n        /** Scene subtrees types\r\n         * @remark\r\n         * Available types\r\n         */\r\n        readonly subtrees?: ("terrain" | "triangles" | "lines" | "points")[];\r\n\r\n        readonly variants?: ("deviation" | "intensity")[];\r\n\r\n        /** Date of scene creation */\r\n        readonly dateCreated: Date;\r\n\r\n        /** Date of when scene was last saved */\r\n        readonly dateLastSaved: Date;\r\n\r\n        /** Scene description. */\r\n        description?: string;\r\n\r\n        /** Geological location of scene.\r\n         * @remarks\r\n         * This location is used for calculating correct lighting/sun position for a given time and date. In future, it may also be used for google earth-like background settings and map icons etc. For static structures in particular, providing an accurate location is thus recommended.\r\n         */\r\n        location?: GeoLocation;\r\n\r\n        /** Local timezone expressed in hours from GMT.\r\n         * @remarks\r\n         * Information for calculating correct lighting/sun position using local time rather than UTC.\r\n         *\r\n         */\r\n        timezone?: number;\r\n\r\n        /** The bounding sphere of the scene in world space.\r\n         * @remarks\r\n         * This property is useful for e.g. initial camera positioning based on approximate scene size and center.\r\n         */\r\n        readonly boundingSphere: BoundingSphere;\r\n\r\n        /** Return a queryable object reference.\r\n         * @param id Object Id\r\n         */\r\n        getObjectReference(id: ObjectId): ObjectReference;\r\n\r\n        /** Search for objects.\r\n         * @param filter {@link SearchOptions} filtering options.\r\n         * @param signal Abort request signal.\r\n         * @remarks\r\n         * Scenes contains objects with associated properties.\r\n         * Loading scenes with millions of objects direcly into memory may be slow or even impossible on memory constrained devices.\r\n         * This function lets you selectively load object properties based on some criteria.\r\n         * An example of this is if you want to make a virtual tree view that only load child nodes on demand when the user expands a folder to make your UI scale to very large scenes.\r\n         * ```typescript\r\n         * const children = scene.search({ parentPath: "rootfolder/subfolder", descentDepth: 1});\r\n         * for await (const child of children) {\r\n         * // TODO: append child\'s properties to UI\r\n         * }\r\n         * ```\r\n         * @returns Async iterator of {@link HierarcicalObjectReference}\r\n         */\r\n        search(filter: SearchOptions, signal?: AbortSignal): AsyncIterableIterator<HierarcicalObjectReference>;\r\n\r\n        /** Returns all descendants */\r\n        descendants(object: HierarcicalObjectReference, signal: AbortSignal | undefined): Promise<ObjectId[]>;\r\n\r\n        /** Compute sun position.\r\n         * @param time Desired date and time of day in universal time (UTC).\r\n         * @remarks\r\n         * The computation will take into account seasonal changes as well as time.\r\n         * The {@link timezone} may be useful to provide the correct UTC time in the physical area described by the scene but is not used by this method directly.\r\n         * @returns The sun position, which can then be used in the render settings to visualize the light conditions for a given site on the given time.\r\n         */\r\n        computeSunPosition(time: Date): { azimuth: number; inclination: number };\r\n\r\n        /** List of dynamic objects currently in scene.\r\n         * @remarks\r\n         * To add a new dynamic object, see {@link createDynamicObject}.\r\n         * To remove a dynamic object, see {@link DynamicObject.dispose}.\r\n         */\r\n        readonly dynamicObjects: IterableIterator<DynamicObject>;\r\n\r\n        /** Create a new dynamic object.\r\n         * @param asset The geometry asset to use for this object.\r\n         * @returns A new dynamic object, whose state is initially invisible by default.\r\n         */\r\n        createDynamicObject(asset: DynamicAsset): DynamicObject;\r\n\r\n        /** An object that allows sets of objects to be highlighted using different color transforms. */\r\n        readonly objectHighlighter: ObjectHighlighter;\r\n    }\r\n\r\n    /** Camera motion controller.\r\n     * @remarks\r\n     * A motion controller fascilitates navigating a camera in space from user input.\r\n     */\r\n    export interface CameraController {\r\n        /** Defines mouse buttons actions.\r\n         * @param mouseButtonsMap Bitmask definition what buttons will rotate, pan and orbit camera.\r\n         * @remarks\r\n         * Bit mask of buttons:\r\n         * 1 - left button.\r\n         * 2 - right button.\r\n         * 4 - middle button.\r\n         * Default value: { rotate: 1, pan: 4, orbit: 2, pivot: 2 }\r\n         * rotate, pan and orbit are movement while button hold\r\n         * pivot is setting of pivot point for orbit rotation on button down\r\n         * You could disable some action by do not set it or set to 0, like { rotate: 1, pan: 2 } or { rotate: 1, pan: 2, orbit: 0}\r\n         * Here could be combination of buttons, for example if you want use right button for rotation and left or middle button for panning and no orbit then value should be { rotate: 2, pan: 5 }\r\n         */\r\n        mouseButtonsMap: { rotate: number; pan: number; orbit: number; pivot: number };\r\n\r\n        /** Defines touch fingers actions.\r\n         * @param fingersMap defines how many fingers will rotate, pan and orbit camera.\r\n         * @remarks\r\n         * Default value: { rotate: 1, pan: 3, orbit: 3, pivot: 3 }\r\n         * rotate, pan and orbit are movement while holding fingers\r\n         * pivot is setting of pivot point for orbit rotation\r\n         * You could disable some action by do not set it or set to 0, like { rotate: 1, pan: 2 } or { rotate: 1, pan: 2, orbit: 0}\r\n         */\r\n        fingersMap: { rotate: number; pan: number; orbit: number; pivot: number };\r\n\r\n        /** Zoom to area of interest.\r\n         * @param bounds The bounding volume that should be brought into view.\r\n         * @remarks\r\n         * Bounding volumes can be gotten from the scene itself, or an selection of objects within the scene.\r\n         * A typical case is to update the 3D view to reflect some object selection.\r\n         * The controller will attempt to position the camera at a reasonable distance from the specified volume, using its center as the focal point.\r\n         * The controller will not attempt to avoid moving through walls etc.\r\n         */\r\n        zoomTo(bounds: BoundingSphere): void;\r\n\r\n        /** Move camera to exact position and rotation. */\r\n        moveTo(position: vec3, rotation: quat): void;\r\n\r\n        /** Whether controller is enabled. Default is true. */\r\n        enabled: boolean;\r\n\r\n        /** Whether to automatically zoom to scene extents when new scene is selected. Default is true. */\r\n        autoZoomToScene?: boolean;\r\n\r\n        /** Controller parameters */\r\n        readonly params: Required<CameraControllerParams>;\r\n    }\r\n\r\n    /** Static camera motion controller parameters. */\r\n    export interface StaticControllerParams {\r\n        /** The kind of camera controller. */\r\n        kind: "static";\r\n\r\n        /** The world space coordinate of the camera itself (default [0,0,1]). */\r\n        position?: vec3;\r\n\r\n        /** The world space coordinate to look at (default [0,0,0]). */\r\n        target?: vec3;\r\n\r\n        /** The world space up vector (default [0,1,0]). */\r\n        up?: vec3;\r\n    }\r\n\r\n    /** Turntable camera motion controller parameters. */\r\n    export interface TurntableControllerParams {\r\n        /** The kind of camera controller. */\r\n        kind: "turntable";\r\n\r\n        /** The world space coordinate to orbit around. */\r\n        pivotPoint?: vec3;\r\n\r\n        /** The camera distance relative to pivot point in meters. */\r\n        distance?: number;\r\n\r\n        /** The camera elevation relative to pivot point in meters. */\r\n        elevation?: number;\r\n\r\n        /** The current turntable rotation angle in degrees (+/-180) */\r\n        rotation?: number;\r\n\r\n        /** The velocity with which the camera rotates in degrees/second. */\r\n        rotationalVelocity?: number;\r\n    }\r\n\r\n    /** Orbit type camera motion controller */\r\n    export interface OrbitControllerParams {\r\n        /** The kind of camera controller. */\r\n        kind: "orbit";\r\n\r\n        /** The world space coordinate to orbit around. (0,0,0) is default. */\r\n        pivotPoint?: vec3;\r\n\r\n        /** The current pitch of camera in degrees (+/-90) */\r\n        pitch?: number;\r\n\r\n        /** The current yaw of camera in degrees (+/-180) */\r\n        yaw?: number;\r\n\r\n        /** The camera distance relative to pivot point in meters. */\r\n        distance?: number;\r\n\r\n        /** The camera distance relative to pivot point in meters. */\r\n        maxDistance?: number;\r\n\r\n        /** The velocity with which the camera moves through space in meters/second */\r\n        linearVelocity?: number;\r\n\r\n        /** The velocity with which the camera rotates in degrees/second. */\r\n        rotationalVelocity?: number;\r\n    }\r\n\r\n    /** Flight type camera motion controller */\r\n    export interface FlightControllerParams {\r\n        /** The kind of camera controller. */\r\n        kind: "flight";\r\n\r\n        /** The world space coordinate of camera. (0,0,0) is default. */\r\n        position?: vec3;\r\n\r\n        /** The world space coordinate to orbit around. (0,0,0) is default. */\r\n        pivotPoint?: vec3 | false;\r\n\r\n        /** The current pitch of camera in degrees (+/-90) */\r\n        pitch?: number;\r\n\r\n        /** The current yaw of camera in degrees (+/-180) */\r\n        yaw?: number;\r\n\r\n        /** The velocity with which the camera moves through space in meters/second */\r\n        linearVelocity?: number;\r\n\r\n        /** The allow automatic zoom velocity according last pivot point distance */\r\n        autoZoomSpeed?: boolean;\r\n\r\n        /** Near camera clipping distance */\r\n        near?: number;\r\n\r\n        /** Far camera clipping distance */\r\n        far?: number;\r\n\r\n        /** Camera flight time in zoomTo*/\r\n        flightTime?: number;\r\n\r\n        /** Camera Field of View in degrees */\r\n        fieldOfView?: number;\r\n    }\r\n\r\n    /** Flight type camera motion controller */\r\n    export interface OrthoControllerParams {\r\n        /** The kind of camera controller. */\r\n        kind: "ortho";\r\n\r\n        /** The world space reference coordinate system to move along. Identity matrix is default. */\r\n        referenceCoordSys?: ReadonlyMat4;\r\n\r\n        /** The position in the reference coordinate system. (0,0,0) is default. */\r\n        position?: vec3;\r\n\r\n        /** The velocity with which the camera moves through space in meters/second */\r\n        linearVelocity?: number;\r\n\r\n        /** Near camera clipping distance */\r\n        near?: number;\r\n\r\n        /** Far camera clipping distance */\r\n        far?: number;\r\n\r\n        /** Camera (vertical) field of view in meters. */\r\n        fieldOfView?: number;\r\n    }\r\n\r\n    export type CameraControllerParams = StaticControllerParams | TurntableControllerParams | OrbitControllerParams | FlightControllerParams | OrthoControllerParams;\r\n\r\n    /** Neutral highlight parameters */\r\n    export interface NeutralHighlightParams {\r\n        /** The kind of highlight. */\r\n        kind: "neutral";\r\n    }\r\n\r\n    /** Transparent highlight parameters */\r\n    export interface TransparentHighlightParams {\r\n        /** The kind of highlight. */\r\n        kind: "transparent";\r\n        /** The opacity to assign. Value must between 0.0 (fully transparent) and 1.0 (fully opaque) */\r\n        opacity: number;\r\n    }\r\n\r\n    /** Color assign highlight parameters */\r\n    export interface ColorHighlightParams {\r\n        /** The kind of highlight. */\r\n        kind: "color";\r\n        /** The color to assign. */\r\n        color: ColorRGB | ColorRGBA;\r\n    }\r\n\r\n    /** Red, green, blue, alpha transform highlight parameters */\r\n    export type RGBATransformHighlightParams = {\r\n        /** The kind of highlight. */\r\n        kind: "rgba";\r\n    } & AtLeastOne<RGBAOptions>;\r\n\r\n    /** Hue, saturation, lightness, alpha transform highlight parameters */\r\n    export type HSLATransformHighlightParams = {\r\n        /** The kind of highlight. */\r\n        kind: "hsla";\r\n    } & AtLeastOne<HSLAOptions>;\r\n\r\n    export type HighlightParams = NeutralHighlightParams | TransparentHighlightParams | ColorHighlightParams | RGBATransformHighlightParams | HSLATransformHighlightParams;\r\n\r\n    /** Output from object picking */\r\n    export interface PickInfo {\r\n        /** ObjectId of picked object */\r\n        objectId: ObjectId;\r\n        /** World space position of picked pixel */\r\n        position: vec3;\r\n        /** World space normal of picked pixel */\r\n        normal: vec3;\r\n    }\r\n\r\n    export interface MeasureInfo {\r\n        /** World space position of picked pixel */\r\n        position: vec3;\r\n        /** Undefined if the point is on an edge */\r\n        normalVS: vec3 | undefined;\r\n        /** Deviation of picked pixel */\r\n        deviation: number | undefined;\r\n        /** Intensity of picked pixel */\r\n        intensity: number | undefined;\r\n    }\r\n\r\n    /** Rendering performance statistics */\r\n    export interface PerformanceStatistics {\r\n        /** # milliseconds spent on various aspects of rendering last frame. */\r\n        cpuTime: {\r\n            animation: number; // time spent in main thread doing camera updates and animations\r\n            render: {\r\n                draw: number; // time spent on WebGL rendering\r\n                update: number; // time spent updating GPU buffers\r\n                total: number; // total time spent for rendering including vsync\r\n            };\r\n            geometry: {\r\n                update: number; // time spent traversing and updating octree\r\n            };\r\n        };\r\n        /** # Triangles rendered in last frame. */\r\n        triangles: number;\r\n        /** # Points rendered in last frame. */\r\n        points: number;\r\n        /** # draw calls emitted in last frame. */\r\n        drawCalls: number;\r\n        /** Are all pending nodes loaded and sent to rendering pipeline? */\r\n        sceneResolved: boolean;\r\n        /** Are all pending nodes update done in rendering pipeline? */\r\n        renderResolved: boolean;\r\n        /** Is device weak in rendering performance? */\r\n        weakDevice: boolean;\r\n        /** Camera generation */\r\n        cameraGeneration: number;\r\n    }\r\n\r\n    /** Parameters for directional lighting. */\r\n    export interface DirectionalLight {}\r\n\r\n    /** Node for terrain elevation color gradient curve. */\r\n    export interface ElevationColorGradientNode {\r\n        /** Elevation above/below sea level in meters. */\r\n        readonly elevation: number;\r\n        /** Color to use at this elevation. */\r\n        readonly color: ColorRGB;\r\n    }\r\n\r\n    /** Node for point cloud deviation color gradient curve. */\r\n    export interface DeviationColorGradientNode {\r\n        /** Deviation. */\r\n        readonly deviation: number;\r\n        /** Color to use at this deviation. */\r\n        readonly color: ColorRGBA;\r\n    }\r\n\r\n    /** Node for point cloud intensity color gradient curve. */\r\n    export interface IntensityColorGradientNode {\r\n        /** Intensity. */\r\n        readonly intensity: number;\r\n        /** Color to use at this deviation. */\r\n        readonly color: ColorRGBA;\r\n    }\r\n\r\n    /** Render settings\r\n     * @remarks\r\n     * These settings controls various visual aspects of the 3D view.\r\n     */\r\n    export interface RenderSettings {\r\n        /** Display settings */\r\n        readonly display: {\r\n            /** Display width in pixels. */\r\n            width: number;\r\n            /** Display height in pixels. */\r\n            height: number;\r\n        };\r\n\r\n        /** Grid settings */\r\n        readonly grid: {\r\n            /** Enable grid plane. */\r\n            enabled: boolean;\r\n            /** Number of major lines, odd number needed to have lines go through origo. */\r\n            majorLineCount: number;\r\n            /** Number of minor lines between major lines. */\r\n            minorLineCount: number;\r\n            /** Origo of the grid */\r\n            origo: vec3;\r\n            /** X axis of the grid, length determines the distance between lines*/\r\n            axisX: vec3;\r\n            /** Y axis of the grid, length determines the distance between lines*/\r\n            axisY: vec3;\r\n            /** Color of major grid lines*/\r\n            majorColor: ColorRGB;\r\n            /** Color of minor grid lines*/\r\n            minorColor: ColorRGB;\r\n        };\r\n\r\n        /** Settings for rendering of background.\r\n         */\r\n        readonly background: {\r\n            /** Background color.\r\n             * @remarks\r\n             * Setting the alpha component < 1 will generate a transparent background.\r\n             * If undefined, background will use image from environment map, or default color if no environment is set.\r\n             */\r\n            color: ColorRGBA | undefined;\r\n        };\r\n\r\n        /** Clipping planes settings.\r\n         * @deprecated Use clippingVolume instead.\r\n         * @remarks\r\n         * Clipping planes allows for an axis alligned box to define what volume will be rendered or not.\r\n         * This is useful for rendering various cross sections and revealing internal geometry.\r\n         */\r\n        readonly clippingPlanes: {\r\n            /** Whether to clip geometry by the actual bounding box or not. */\r\n            enabled: boolean;\r\n            /** Whether to clip geometry inside or outside the actual bounding box. */\r\n            inside: boolean;\r\n            /** Whether to show the actual bounding box or not. */\r\n            showBox: boolean;\r\n            /** The axis aligned bounding volume. */\r\n            bounds: AABB;\r\n            /** Highlighted side. */\r\n            highlight: number;\r\n        };\r\n\r\n        /** Clipping volume settings.\r\n         * @remarks\r\n         * Clipping volume allows for a set of up to 6 planes to define a volume that excluded from rendering.\r\n         * This is useful for rendering various cross sections and revealing internal geometry.\r\n         */\r\n        readonly clippingVolume: {\r\n            /** Whether to clip geometry by the actual bounding box or not. */\r\n            enabled: boolean;\r\n            /** How multiple clipping planes are combined. Default: "union" */\r\n            mode: "intersection" | "union";\r\n            /** List of clipping planes (max 6), expressed as plane normal (x,y,z) and offset from origo (w) in a 4D world space vector. */\r\n            planes: readonly ReadonlyVec4[];\r\n        };\r\n\r\n        /** Current background/IBL environment.\r\n         * @remarks\r\n         * Environments are a pre-baked set of textures for background and lighting information.\r\n         * For retrieving a list of available environments, see {@link API.availableEnvironments}.\r\n         * An environment must be loaded before it can be assigned here, via {@link View.loadEnvironment}.\r\n         * Assigning an environment impacts lighting if no {@link light.sun} is defined, and also background images {@link background} if no color is defined.\r\n         * Image based lighting (IBL) uses light information from HDRI panoramic images to create a more natural looking light and ambience.\r\n         * If undefined, a basic directional sun lighting model will be used instead, allowing for dynamic changes in light color and direction at the expense of esthetics.\r\n         */\r\n        environment?: Environment;\r\n\r\n        /** Camera light exposure as stops of power of 2.\r\n         * @remarks\r\n         * Negative values darkens the image, while positive ones brightens it.\r\n         * The default value is 0.0.\r\n         */\r\n        exposure?: number;\r\n\r\n        /** Light settings */\r\n        readonly light: {\r\n            /** Ambient hemisphere light, emulating indirect light scattered from atmosphere. */\r\n            readonly ambient: {\r\n                /** Brightness expressed as a scalar from 0.0 (none), to 1.0 (max). */\r\n                brightness: number;\r\n            };\r\n\r\n            // /** Pre-baked indirect illumination.\r\n            //  * @remarks\r\n            //  * As calculating indirect illumination is a very compute intensive operation, it is currently performed as a pre-process stage on dedicated servers in the cloud.\r\n            //  * Not all models undergoes this process, however, and changes to e.g. sunlight and scene composition will require a rebake for correct lighting.\r\n            //  */\r\n            // readonly baked: {\r\n            //     /** Brightness expressed as a scalar from 0.0 (none), to 1.0 (sunny). */\r\n            //     brightness: number;\r\n            //     /** Range of input values to use, expressed as a [low,high] range, typically [0,1] in most cases. */\r\n            //     readonly range: [low: number, high: number];\r\n            // };\r\n\r\n            /** Camera local light. */\r\n            readonly camera: {\r\n                /** Brightness expressed as a scalar from 0.0 (none), to 1.0 (bright). */\r\n                brightness: number;\r\n                /** Fall-off distance, beyond which this light is effectively disabled. */\r\n                distance: number;\r\n            };\r\n\r\n            /** Direct sunlight. */\r\n            readonly sun: {\r\n                /** Brightness expressed as a scalar from 0.0 (none), to 1.0 (sunny). */\r\n                brightness: number;\r\n                /** Sun position on the sky. */\r\n                readonly position: {\r\n                    /** Solar azimuth angle in degrees, where 0\xb0 is due north, 90\xb0 is due east and 270\xb0 due west. */\r\n                    azimuth: number;\r\n                    /** Solar elevation angle in degrees, where 0\xb0 at the horizon and 90\xb0 is straight up. */\r\n                    inclination: number;\r\n                };\r\n                /** If set then sun {@link position} on the sky will be calculated automatically based on scene {@link Scene.location}, {@link Scene.timezone} and this time. */\r\n                time?: Date;\r\n            };\r\n\r\n            // /** Shadows settings (default settings should work in most cases). */\r\n            // readonly shadows: {\r\n            //     /** enable shadows (default: false). */\r\n            //     enabled: boolean;\r\n            //     /** Default value = -0.000005. */\r\n            //     bias: number;\r\n            //     /** Default value = -200. */\r\n            //     left: number;\r\n            //     /** Default value = 200. */\r\n            //     right: number;\r\n            //     /** Default value = -200. */\r\n            //     bottom: number;\r\n            //     /** Default value = 200. */\r\n            //     top: number;\r\n            // };\r\n        };\r\n\r\n        /** Color transforms for various highlighting groups.\r\n         * @remarks\r\n         * These highlights are used by the {@link scene.objectHighlighter}.\r\n         * Modifing the highlights is done by assigning a new array, rather than mutating the existing one.\r\n         * The maximum number of highlights supported is currently 256, whereof the last (255) is reserved for hidden objects.\r\n         * The highlight at index 0 is the initial default for all objects and can be used to e.g. highlight all objects that are not selected or otherwise part of another highlighting group.\r\n         */\r\n        objectHighlights: readonly Highlight[];\r\n\r\n        /** Ocean render settings\r\n         * @remarks\r\n         * If undefined, ocean geometry will not be rendered.\r\n         */\r\n        readonly ocean: {\r\n            /** Ocean color */\r\n            color: ColorRGB;\r\n            /** Enable ocean rendering (default false). */\r\n            enabled: boolean;\r\n            /** Ocean opacity (default 0.5).*/\r\n            opacity: number;\r\n        };\r\n\r\n        /** Point cloud settings.\r\n         * @remarks\r\n         * The sizes are cumulative and computed as follows:\r\n         * ``effective_point_pixel_size = max(1, pixelSize + projectedSizeOf(metricSize + tolerance * toleranceFactor))``.\r\n         * Metric size is projected as a 3D sphere at the point origo to deterine pixel size.\r\n         * The term pixel refers to the size of a pixel in the target canvas element, which resolution may differ from that of the render buffer.\r\n         */\r\n        readonly points: {\r\n            /** Point shape. Default is "disc". */\r\n            shape: "disc" | "square";\r\n\r\n            readonly size: {\r\n                /** Point size in pixels. */\r\n                pixel: number | undefined;\r\n                /** Max point size in pixels. */\r\n                maxPixel: number | undefined;\r\n                /** Point size in meters. */\r\n                metric: number | undefined;\r\n                /** The scaling factor for applying the tolerance of the current level of detail to point size.\r\n                 * @remarks\r\n                 * Different levels of detail (LOD) will have different point densities.\r\n                 * Taking this difference into account may result in a more uniform point coverage and visually pleasing result.\r\n                 * The tolerance of each LOD reflects the point merging distance threshold in meters used to reduce # points, or 0 for the original level of detail.\r\n                 */\r\n                toleranceFactor: number;\r\n            };\r\n\r\n            readonly deviation: {\r\n                mode: "on" | "off" | "mix";\r\n                colors: readonly DeviationColorGradientNode[];\r\n            };\r\n\r\n            readonly intensity: {\r\n                mode: "on" | "off" | "mix";\r\n                colors: readonly IntensityColorGradientNode[];\r\n            };\r\n        };\r\n\r\n        /** Render quality settings for adjusting performance to various devices */\r\n        readonly quality: {\r\n            // /** Apply temporal antialiasing when camera stops moving. */\r\n            // antiAliasing: boolean;\r\n\r\n            /** Geometry detail settings. */\r\n            readonly detail: {\r\n                /** Auto adjustment based on current device\'s rendering performance. */\r\n                readonly autoAdjust: {\r\n                    /** Is automatic adjustment enabled? */\r\n                    enabled: boolean;\r\n                    /** Lower bound for automatic adjustment. */\r\n                    min: number;\r\n                    /** Upper bound for automatic adjustment. */\r\n                    max: number;\r\n                };\r\n\r\n                /** Level of geometry detail. 1.0 = reasonable default, >1 more detail, <1 less detail. */\r\n                value: number;\r\n\r\n                /** Max limit for # of triangles used for static LOD geometry.\r\n                 * @remarks\r\n                 *  Adjust this to enforce memory and performance constraints on your device.\r\n                 *  Default value is undefined, which disables enforcement of this limit.\r\n                 *  Triangles from DynamicObjects are not included in the triangle count and thus not contrained by this value.\r\n                 */\r\n                maxLodTriangles?: number;\r\n\r\n                /** Max limit for # of bytes used for textures in static LOD geometry.\r\n                 * @remarks\r\n                 *  Adjust this to accomodate memory constraints on your device.\r\n                 *  Default value is undefined, which disables enforcement of this limit.\r\n                 *  The # bytes refers to the textxure image and does not include memory used for mipmapping or device specific format conversions.\r\n                 *  Hardware compressed textures only count for the compressed byte size.\r\n                 *  Textures from DynamicObjects are not included in the triangle count and thus not contrained by this value.\r\n                 */\r\n                maxLodTextureBytes?: number;\r\n            };\r\n\r\n            /** Resolution settings. */\r\n            readonly resolution: {\r\n                /** Auto adjustment based on current device\'s rendering performance. */\r\n                readonly autoAdjust: {\r\n                    /** Is automatic adjustment enabled? */\r\n                    enabled: boolean;\r\n                    /** Lower bound for automatic adjustment. */\r\n                    min: number;\r\n                    /** Upper bound for automatic adjustment. */\r\n                    max: number;\r\n                };\r\n\r\n                /** Level of pixel resolution, where 1.0 = 1:1 ratio (default) and values lesser than 1 will render in lower resolution than screen and scale up for increased performance. */\r\n                value: number;\r\n            };\r\n        };\r\n\r\n        /** Terrain render settings\r\n         * @remarks\r\n         * If undefined, terrain geometry will not be rendered.\r\n         */\r\n        terrain: {\r\n            /** Elevation gradient color curve, defined by a list of nodes.\r\n             * @remarks\r\n             * Nodes must be sorted in ascending order of elevation!\r\n             * Elevations are defined as in meters above/below sea level (using negative values for sub sea terrain).\r\n             * At least two nodes are required for any sort of gradient.\r\n             * Nodes do not have to be uniformly distributed elevation-wise.\r\n             * To create a discontinuity in the gradient, two adjacent nodes with identical elevation, but different colors may be used.\r\n             * Any elevation outside the min/max range defined by this list will be clamped to the color of the nearest node (min or max), i.e., no extrapolation will occur.\r\n             */\r\n            elevationColors: readonly ElevationColorGradientNode[];\r\n\r\n            /** Draw terrain as background */\r\n            asBackground: boolean;\r\n        };\r\n    }\r\n\r\n    /** A partial, read only variant of render settings for initial settings and updates. */\r\n    export type RenderSettingsParams = Partial<Readonly<RenderSettings>>;\r\n\r\n    export interface GrayscaleParams {\r\n        readonly kind: "gs";\r\n        readonly colorTransform?: ReadonlyMat3;\r\n    }\r\n\r\n    export interface TemporalAntialiasingParams {\r\n        readonly kind: "taa";\r\n        readonly radius?: number;\r\n        readonly reset?: boolean;\r\n    }\r\n\r\n    export interface OutlineParams {\r\n        readonly kind: "outline";\r\n        readonly color?: ReadonlyVec4;\r\n    }\r\n\r\n    export interface ScreenSpaceAmbientOcclusionParams {\r\n        readonly kind: "ssao";\r\n        readonly radius: number;\r\n        readonly samples: number;\r\n        readonly reset?: boolean;\r\n        readonly skipOpacity?: boolean;\r\n    }\r\n\r\n    export type PostEffectParams = GrayscaleParams | TemporalAntialiasingParams | ScreenSpaceAmbientOcclusionParams | OutlineParams;\r\n\r\n    export interface RenderOutput {\r\n        readonly statistics: PerformanceStatistics;\r\n        readonly renderSettings: RenderSettings;\r\n        readonly hasViewChanged: boolean;\r\n        readonly viewWorldMatrix: ReadonlyMat4;\r\n        readonly viewClipMatrix: ReadonlyMat4;\r\n        readonly worldViewMatrix: ReadonlyMat4;\r\n\r\n        /** Pick nearest object (if any) at the specified pixel coordinate.\r\n         * updatePickBuffers() must be called on view to get updated pick information\r\n         * @param x view x coordinate (0=left)\r\n         * @param y view y coordinate (0=top)\r\n         * @returns `undefined` if no object intersection was found.\r\n         */\r\n        pick(x: number, y: number): Promise<PickInfo | undefined>;\r\n\r\n        /** Get {@link MeasureInfo} of nearest object (if any) at the specified pixel coordinate.\r\n         * updatePickBuffers() must be called on view to get updated pick information\r\n         * @param x view x coordinate (0=left)\r\n         * @param y view y coordinate (0=top)\r\n         * @returns `undefined` if no object intersection was found.\r\n         */\r\n        measure(x: number, y: number): Promise<MeasureInfo | undefined>;\r\n\r\n        applyPostEffect(params: PostEffectParams): Promise<void | boolean>;\r\n\r\n        getImage(): Promise<ImageBitmap | undefined>;\r\n    }\r\n\r\n    /** A 3D view.\r\n     * @remarks\r\n     * 3D views will render a scene into a provided canvas element.\r\n     * Any changes to the scene, camera or settings are automatically rendered in a background animation loop.\r\n     * When the camera stops moving, additional frames may also be rendered to incrementally refine the quality of the output image over a certain period.\r\n     * Setting the {@link render} property to false will stop such automatic updates.\r\n     */\r\n    export interface View {\r\n        /** The scene to render.\r\n         * @remarks\r\n         * Assigning a new scene initiates a sequence of geometry downloads that may take a few seconds to produce any visual results and then refine over time.\r\n         */\r\n        scene?: Scene;\r\n\r\n        /** The camera to use. */\r\n        camera: Camera;\r\n\r\n        // /** An HTML element used to automatically resize the canvas to changes in layout.\r\n        //  * @remarks\r\n        //  * By default this will be the parent element of the HTMLCanvasElement, or undefined in the case of OffscreenCanvas.\r\n        //  * You may set it to any HTMLElement, however, or undefined to disable automatic resize.\r\n        //  */\r\n        // container?: HTMLElement | undefined;\r\n\r\n        /** Render the next frame.\r\n         * @remarks\r\n         * This function is meant to be called in a loop.\r\n         * You should avoid calling it from a timer or a requestAnimationFrame callback since it\'s already being throttled to the screen\'s vertical blanking.\r\n         * If the existing state has already been rendered, it will wait until there are changes before initiating a new render.\r\n         * The returned render output object will have methods for post processing and for getting an image you can display in your own canvas.\r\n         * You must call `dispose()` on the returned render output object before you can call this function again.\r\n         * @returns A promise of the rendered output.\r\n         */\r\n        render(frameCallback?: () => void): Promise<RenderOutput>;\r\n\r\n        /** Current render settings. */\r\n        readonly settings: RenderSettings;\r\n\r\n        /** Apply render settings changes using deep copy.\r\n         * @param changes changes to current render settings.\r\n         */\r\n        applySettings(changes: RenderSettingsParams): void;\r\n\r\n        /** Performance statistics from previously rendered frame. */\r\n        readonly performanceStatistics: PerformanceStatistics;\r\n\r\n        /** Flag whether to automatically render or not. Default is true. */\r\n        autoRender: boolean;\r\n\r\n        /** Transfer recently rendered image to a bitmap.\r\n         * @returns A Promise to the transferred bitmap or undefined if device/browser does not yet support this functionality.\r\n         * @remarks See {@link https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas/transferToImageBitmap} for more details.\r\n         */\r\n        transferToImageBitmap(): Promise<ImageBitmap | undefined>;\r\n\r\n        /** Convert image to a data blob.\r\n         * @param options Image encoding options.\r\n         * @returns A Promise to a Blob object representing the latest rendered image or undefined if device/browser does not yet support this functionality.\r\n         * @remarks See {@link https://developer.mozilla.org/en-US/docs/Web/API/OffscreenCanvas/convertToBlob} for more details.\r\n         */\r\n        convertToBlob(options?: ImageEncodeOptions_): Promise<Blob | undefined>;\r\n\r\n        /** Updates the pick buffers */\r\n        updatePickBuffers(): Promise<void>;\r\n\r\n        /** Pick nearest object (if any) at the specified pixel coordinate.\r\n         * @param x view x coordinate (0=left)\r\n         * @param y view y coordinate (0=top)\r\n         * @returns `undefined` if no object intersection was found.\r\n         */\r\n        pick(x: number, y: number): Promise<PickInfo | undefined>;\r\n\r\n        /** Get {@link MeasureInfo} of nearest object (if any) at the specified pixel coordinate.\r\n         * @param x view x coordinate (0=left)\r\n         * @param y view y coordinate (0=top)\r\n         * @returns `undefined` if no object intersection was found.\r\n         */\r\n        measure(x: number, y: number): Promise<MeasureInfo | undefined>;\r\n    }\r\n\r\n    /** Database interface to retrive object\'s data in scene. Used internally from loaded {@link Scene} interface.\r\n     * @remarks\r\n     * This interface is usually created automatically based on scene creation.\r\n     * You may make your own implementation for custom data model, e.g. for testing or in-house databases.\r\n     */\r\n    export interface ObjectDB {\r\n        /** Get {@link ObjectData} by scene object id */\r\n        getObjectMetdata(id: number): Promise<ObjectData>;\r\n\r\n        /** Search for objects.\r\n         * @param filter {@link SearchOptions} filtering options.\r\n         * @param signal Abort request signal.\r\n         * @remarks\r\n         * See {@link Scene.search} for more details.\r\n         * @returns Async iterator of {@link HierarcicalObjectReference}\r\n         */\r\n        search(filter: SearchOptions, signal: AbortSignal | undefined): AsyncIterableIterator<HierarcicalObjectReference>;\r\n    }\r\n\r\n    /** Background/IBL environment description */\r\n    export interface EnvironmentDescription {\r\n        /** Display name of environment */\r\n        readonly name: string;\r\n\r\n        /** Data URL. */\r\n        readonly url: string;\r\n\r\n        /** Thumbnail URL. */\r\n        readonly thumnbnailURL: string;\r\n    }\r\n\r\n    /** An in-memory instance of an environment, ready for rendering. */\r\n    export interface Environment {\r\n        /** Loaded environment id. */\r\n        readonly id: number;\r\n\r\n        /** Unload environment instance and release all resources.\r\n         * @remarks\r\n         * It is safe to call this function on an environment if it\'s currently not assigned to any view, or if all assigned views have rendered it at least once.\r\n         */\r\n        dispose(): Promise<void>;\r\n    }\r\n\r\n    /** A NovoRender API instance. */\r\n    export interface API {\r\n        /** API version string, expressed using semantic versioning {@link https://semver.org/}. */\r\n        readonly version: string;\r\n\r\n        /** Stop all rendering and release all resources.\r\n         * @remarks\r\n         * Calling this function will effectively destroy this instance of the API and any associated scenes and views etc.\r\n         * This function allows you to explicitly release the associated GPU resources and memory caches used by the API without waiting for the garbage collector to do so.\r\n         */\r\n        dispose(): void;\r\n\r\n        /**\r\n         * Enable or disable automatic rendering.\r\n         * @remarks\r\n         * This value is set to true by default when a new API is created.\r\n         * When true, the api will use requestAnimationFrame() callback to automatically update all active views and controllers.\r\n         * Setting it to false will have the effect of pausing all rendering and camera motion.\r\n         * You may still call {@link update} to manually render all views frame and update camera motion controllers.\r\n         */\r\n        run: boolean;\r\n\r\n        /**\r\n         * Callback that is called on each frame just before rendering.\r\n         * @remarks\r\n         * Using this callback instead of in your own requestAnimationFrame() callback is recommended to ensure your updates are applied consistently and are properly synchronized.\r\n         * If you have disabled automatic rendering by setting {@link run} = false, this callback is not called unless you manually call {@link update}.\r\n         */\r\n        animate: FrameRequestCallback | undefined;\r\n\r\n        /**\r\n         * Manually update all views and camera controllers.\r\n         * @remarks\r\n         * If you have disabled automatic rendering by setting {@link run} = false, you can call this function to manually update instead.\r\n         * This may be useful if you are using requestAnimationFrame yourself and want to have full control over the order by which state gets updated.\r\n         * The returned promise will resolve at the next animation frame, typically 1/60 of a second, which can be useful if you intend to run a realtime update loop.\r\n         */\r\n        update(): Promise<void>;\r\n\r\n        /**\r\n         * Load the specificed scene into memory.\r\n         * @remarks\r\n         * The loaded scene will not include all 3D or object data immediately as these are automatically downloaded on demand.\r\n         * @param url The scene (directory) url.\r\n         * @returns A promise of the loaded {@link Scene}.\r\n         */\r\n        loadScene(id: URL | string, db?: ObjectDB): Promise<Scene>;\r\n\r\n        /**\r\n         * Load the specificed asset into memory.\r\n         * @remarks\r\n         * Assets must be passed to {@link Scene.createDynamicObject} to be rendered.\r\n         * Currently, this must be a {@link https://www.khronos.org/gltf/ glTF} file (*.gltf | *.glb).\r\n         * Cross domain urls requires CORS headers to be set appropriately.\r\n         * @param url The asset url.\r\n         * @returns A promise of the loaded {@link DynamicAsset}.\r\n         */\r\n        loadAsset(url: URL): Promise<DynamicAsset>;\r\n\r\n        /**\r\n         * Load the specificed environment into memory.\r\n         * @returns A promise of the loaded {@link Environment}.\r\n         */\r\n        loadEnvironment(environment: EnvironmentDescription): Promise<Environment>;\r\n\r\n        /**\r\n         * Create a 3D View.\r\n         * @param settings Initial {@link RenderSettingParams} settings to use for view.\r\n         * @remarks It is recommend that you specify the initial display pixel width and height here to avoid unnecessary reallocation of render buffers.\r\n         * @returns A promise of a newly created {@link View}.\r\n         */\r\n        createView(settings?: RenderSettingsParams, htmlRenderCanvas?: HTMLCanvasElement): Promise<View>;\r\n\r\n        /** Create an object highlight\r\n         * @param params Highlight parameters.\r\n         * @returns A highlight object that can be used in {@link RenderSettings.objectHighlights}.\r\n         */\r\n        createHighlight(params: NeutralHighlightParams): Highlight;\r\n\r\n        /** Create an object highlight\r\n         * @param params Highlight parameters.\r\n         * @returns A highlight object that can be used in {@link RenderSettings.objectHighlights}.\r\n         */\r\n        createHighlight(params: TransparentHighlightParams): Highlight;\r\n\r\n        /** Create an object highlight\r\n         * @param params Highlight parameters.\r\n         * @returns A highlight object that can be used in {@link RenderSettings.objectHighlights}.\r\n         */\r\n        createHighlight(params: ColorHighlightParams): Highlight;\r\n\r\n        /** Create an object highlight\r\n         * @param params Highlight parameters.\r\n         * @returns A highlight object that can be used in {@link RenderSettings.objectHighlights}.\r\n         */\r\n        createHighlight(params: RGBATransformHighlightParams): Highlight;\r\n\r\n        /** Create an object highlight\r\n         * @param params Highlight parameters.\r\n         * @returns A highlight object that can be used in {@link RenderSettings.objectHighlights}.\r\n         */\r\n        createHighlight(params: HSLATransformHighlightParams): Highlight;\r\n\r\n        /**\r\n         * Create a camera motion controller.\r\n         * @param params The controller parameters.\r\n         * @returns The controller object\r\n         */\r\n        createCameraController(params: StaticControllerParams): CameraController;\r\n\r\n        /**\r\n         * Create a camera motion controller.\r\n         * @param params The controller parameters.\r\n         * @returns The controller object\r\n         */\r\n        createCameraController(params: TurntableControllerParams): CameraController;\r\n\r\n        /**\r\n         * Create a camera motion controller.\r\n         * @param params The controller parameters.\r\n         * @param domElement The HTML DOM element to listen for mouse/touch events. This can only be set when the controller is created.\r\n         * @returns The controller object\r\n         */\r\n        createCameraController(params: OrbitControllerParams, domElement: HTMLElement): CameraController;\r\n\r\n        /**\r\n         * Create a camera motion controller.\r\n         * @param params The controller parameters.\r\n         * @param domElement The HTML DOM element to listen for mouse/touch events. This can only be set when the controller is created.\r\n         * @returns The controller object\r\n         */\r\n        createCameraController(params: FlightControllerParams, domElement: HTMLElement): CameraController;\r\n\r\n        /**\r\n         * Create a camera motion controller.\r\n         * @param params The controller parameters.\r\n         * @param domElement The HTML DOM element to listen for mouse/touch events. This can only be set when the controller is created.\r\n         * @returns The controller object\r\n         */\r\n        createCameraController(params: OrthoControllerParams, domElement: HTMLElement): CameraController;\r\n\r\n        /**\r\n         * Retrieve list of available background/IBL environments.\r\n         * @param indexUrl The absolute or relative url of the index.json file. Relative url will be relative to the novorender api script url. If undefined, "/assets/env/index.json" will be used by default.\r\n         * @param domElement The HTML DOM element to listen for mouse/touch events. This can only be set when the controller is created.\r\n         * @returns The controller object\r\n         */\r\n        availableEnvironments(indexUrl?: string): Promise<readonly EnvironmentDescription[]>;\r\n    }\r\n\r\n    export type PathInfo = { path: string; centerDepth: number; originalIndex: number };\r\n    /** API creation options */\r\n    export interface APIOptions {\r\n        /** Url (without trailing slash) for alternative assets location. The default value is "https://blobs.novorender.com". */\r\n        assetsUrl?: string;\r\n        webGL1Only?: boolean;\r\n        noOffscreenCanvas?: boolean;\r\n    }\r\n\r\n    /**\r\n     * Create an instance of the NovoRender API.\r\n     * @param options Custom settings {@link APIOptions} to create API.\r\n     * @returns An initialized API object\r\n     * @throws Error if current browser and device has insufficient 3D rendering capabilities.\r\n     */\r\n    export function createAPI(options?: APIOptions): API;\r\n\r\n    /**\r\n     * List of well known scene ids used for testing or demos.\r\n     */\r\n    export const enum WellKnownSceneUrls {\r\n        empty = "empty",\r\n        cube = "cube",\r\n        oilrig = "https://blobs.novorender.com/9fb7bdf8ae8445189573681194718db8/",\r\n        condos = "https://blobs.novorender.com/1169297611ae33f63132f264ed34e265/",\r\n    }\r\n\r\n    // Extended interfaces for internal use only\r\n    export namespace Internal {\r\n        export interface CameraExt extends Camera {\r\n            readonly hasChanged: boolean; // has camera values been changed since last update/render?\r\n            readonly generation: number;\r\n        }\r\n\r\n        export interface CameraControllerExt extends CameraController {\r\n            update(camera: Camera | undefined, sceneVolume: BoundingSphere | undefined, deltaTime: number): void;\r\n            connect(): void;\r\n            disconnect(): void;\r\n            reset(): void;\r\n        }\r\n\r\n        export interface RenderSettingsExt extends RenderSettings {\r\n            readonly diagnostics: {\r\n                maxQueueSize: number;\r\n                holdDynamic: boolean;\r\n                showBoundingBoxes: boolean;\r\n            };\r\n\r\n            /** Advanced render settings. */\r\n            readonly advanced: {\r\n                /** Double sided face rendering. */\r\n                readonly doubleSided: {\r\n                    /** Render opaque surfaces as double sided. */\r\n                    opaque: boolean;\r\n                    /** Render transparent surface as double sided. */\r\n                    transparent: boolean;\r\n                };\r\n                /** Hide Terrain */\r\n                hideTerrain: boolean;\r\n                /** Hide Point Clouds */\r\n                hidePoints: boolean;\r\n                /** Hide triangulated geometry */\r\n                hideTriangles: boolean;\r\n                /** Hide lines */\r\n                hideLines: boolean;\r\n            };\r\n            readonly outline: {\r\n                enable: boolean;\r\n                color?: ReadonlyVec4;\r\n            };\r\n            readonly generation: number;\r\n        }\r\n    }\r\n\r\n    export type CylinerMeasureType = "center" | "closest" | "furthest";\r\n\r\n    /** Additional options for measurement */\r\n    export interface MeasureSettings {\r\n        /* Where to measure cylinder from, in case of measure between two cylinder, same option will be used for both*/\r\n        cylinderMeasure: CylinerMeasureType;\r\n    }\r\n\r\n    /** Information about object to draw for measurement */\r\n    export interface DrawObject {\r\n        /** Type of object to draw */\r\n        drawType: "lines" | "filled" | "vertex";\r\n        /** 2d screen coordinates according to current camera */\r\n        vertices: ReadonlyVec2[];\r\n    }\r\n\r\n    /** MeasurementValues is a collection of values for any measurment */\r\n    export type MeasurementValues = EdgeValues | FaceValues | DuoMeasurementValues;\r\n\r\n    /** EdgeValues is a collection of values for measurment on a single edge */\r\n    export type EdgeValues = LineValues | ArcValues;\r\n\r\n    /** LineValues is a collection of values for measuring a single line */\r\n    export interface LineValues {\r\n        kind: "line";\r\n        /** Distance from the start to the end of the line */\r\n        distance: Number;\r\n        /** Gradient of the line */\r\n        gradient: vec3;\r\n        /** The start of the line */\r\n        start: vec3;\r\n        /** The end of the line */\r\n        end: vec3;\r\n    }\r\n\r\n    /** ArcValues is a collection of values for measuring a single arc */\r\n    export interface ArcValues {\r\n        kind: "arc";\r\n        /** Radius of the arc */\r\n        radius: number;\r\n        /** Angle of the arc segment */\r\n        totalAngle: number;\r\n    }\r\n\r\n    /** FaceValues is a collection of values for measurment on a single face */\r\n    export type FaceValues = PlaneValues | CylinderValues;\r\n\r\n    /** PlaneValues is a collection of values for measuring a single Plane */\r\n    export interface PlaneValues {\r\n        kind: "plane";\r\n        /** Width of the plane */\r\n        width?: number;\r\n        /** Height of the plane */\r\n        height?: number;\r\n        /** Largest outer radius of the plane in case of only arcs */\r\n        outerRadius?: number;\r\n        /** Largest inner radius of the plane in case of only arcs */\r\n        innerRadius?: number;\r\n        /** Normal of the plane */\r\n        normal: vec3;\r\n        /** Calculated area of the plane */\r\n        area?: number;\r\n        /** Corner vertices of the plane */\r\n        vertices: vec3[];\r\n        /** Outer edges of the plane*/\r\n        outerEdges: EdgeValues[];\r\n        /** Inner edges of the plane*/\r\n        innerEdges: EdgeValues[][];\r\n        /** Y value of the plane origin*/\r\n        heightAboveXyPlane?: number;\r\n    }\r\n\r\n    /** CylinderValues is a collection of values for measuring a single cylinder */\r\n    export interface CylinderValues {\r\n        kind: "cylinder";\r\n        /** Cylinder radius */\r\n        radius: number;\r\n        /** Start of the line going in the center of the cylinder */\r\n        centerLineStart: vec3;\r\n        /** End of the line going in the center of the cylinder */\r\n        centerLineEnd: vec3;\r\n    }\r\n\r\n    /** DuoMeasurementValues is a collection of values for measuring two objects */\r\n    export interface DuoMeasurementValues {\r\n        /** Total distance between the objects */\r\n        distance?: number;\r\n        /** Total normdistance between the objects from object A */\r\n        normalDistance?: number;\r\n        /** Distance on the X plane between the objects */\r\n        distanceX: number;\r\n        /** Distance on the Y plane between the objects */\r\n        distanceY: number;\r\n        /** Distance on the Z plane between the objects */\r\n        distanceZ: number;\r\n        /** Closest point on object A */\r\n        pointA?: vec3;\r\n        /** Closest point on object B */\r\n        pointB?: vec3;\r\n        /** Point to display normal distance between objects from object A */\r\n        normalPoints?: vec3[] | undefined;\r\n        /** The valid measurement settings for the current measure objects A and B*/\r\n        validMeasureSettings?: { a: boolean; b: boolean };\r\n    }\r\n\r\n    /** Gives values to create a camera based on selected object */\r\n    export interface CameraValues {\r\n        normal: vec3;\r\n        position: vec3;\r\n    }\r\n\r\n    /**  */\r\n    export interface MeasureObject {\r\n        readonly id: ObjectId;\r\n        readonly selectedEntity: MeasureEntity | undefined;\r\n        /** Returns a draw object with 2d screen coordinates*/\r\n        renderMeasureEntity(view: View, width: number, height: number): Promise<DrawObject[] | undefined>;\r\n    }\r\n\r\n    /** Measure api loads from same scene assets. Brep files are required*/\r\n    export interface MeasureAPI {\r\n        loadScene(url: URL | string): Promise<MeasureScene>;\r\n        dispose(): Promise<void>;\r\n        /** Converts world space points to on screen pixel path and points*/\r\n        toPathPoints(points: ReadonlyVec3[], view: View, width: number, height: number): [ReadonlyVec2[], ReadonlyVec2[]];\r\n    }\r\n\r\n    /** Scene with objects being measured. Brep files are required*/\r\n    export interface MeasureScene {\r\n        /** Measure objet, if b is undefined then single measure values are returned else the measurement between 2 objects*/\r\n        measure(a: MeasureEntity, b?: MeasureEntity, settingA?: MeasureSettings, settingB?: MeasureSettings): Promise<MeasurementValues | undefined>;\r\n        /** Measure distance between a measurement object an a 3d point*/\r\n        measureToPoint(a: MeasureEntity, b: vec3, setting?: MeasureSettings): Promise<DuoMeasurementValues | undefined>;\r\n        /** Measure distance between 2 points*/\r\n        pointToPoint(a: vec3, b: vec3): DuoMeasurementValues;\r\n        /** Get suggested camea values for selected object\r\n         * For cylinder values snap to the closest axis on the cylinder*/\r\n        getCameraValues(a: MeasureEntity, cameraDir: vec3): Promise<CameraValues | undefined>;\r\n        /** Downloads the measure data for an object*/\r\n        downloadMeasureObject(id: ObjectId, selectionPosition: vec3): Promise<MeasureObject>;\r\n    }\r\n\r\n    export interface MeasureEntity {\r\n        objectId: ObjectId;\r\n        kind: "edge" | "face" | "vertex";\r\n        pathIndex: number;\r\n        instanceIndex: number;\r\n        parameter: number | ReadonlyVec2 | ReadonlyVec3;\r\n    }\r\n\r\n    export function createMeasureAPI(): MeasureAPI;\r\n}\r\n'},6254:function(e,t,n){n.d(t,{Z:function(){return x}});var r=n(87462),i=n(63366),a=n(94578);function o(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var s=n(67294),l=n(73935),c=!1,d=s.createContext(null),h="unmounted",u="exited",m="entering",p="entered",f="exiting",g=function(e){function t(t,n){var r;r=e.call(this,t,n)||this;var i,a=n&&!n.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?a?(i=u,r.appearStatus=m):i=p:i=t.unmountOnExit||t.mountOnEnter?h:u,r.state={status:i},r.nextCallback=null,r}(0,a.Z)(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===h?{status:u}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==m&&n!==p&&(t=m):n!==m&&n!==p||(t=f)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&"number"!=typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){void 0===e&&(e=!1),null!==t?(this.cancelNextCallback(),t===m?this.performEnter(e):this.performExit()):this.props.unmountOnExit&&this.state.status===u&&this.setState({status:h})},n.performEnter=function(e){var t=this,n=this.props.enter,r=this.context?this.context.isMounting:e,i=this.props.nodeRef?[r]:[l.findDOMNode(this),r],a=i[0],o=i[1],s=this.getTimeouts(),d=r?s.appear:s.enter;!e&&!n||c?this.safeSetState({status:p},(function(){t.props.onEntered(a)})):(this.props.onEnter(a,o),this.safeSetState({status:m},(function(){t.props.onEntering(a,o),t.onTransitionEnd(d,(function(){t.safeSetState({status:p},(function(){t.props.onEntered(a,o)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),r=this.props.nodeRef?void 0:l.findDOMNode(this);t&&!c?(this.props.onExit(r),this.safeSetState({status:f},(function(){e.props.onExiting(r),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:u},(function(){e.props.onExited(r)}))}))}))):this.safeSetState({status:u},(function(){e.props.onExited(r)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(r){n&&(n=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:l.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(n&&!r){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],a=i[0],o=i[1];this.props.addEndListener(a,o)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===h)return null;var t=this.props,n=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,(0,i.Z)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return s.createElement(d.Provider,{value:null},"function"==typeof n?n(e,r):s.cloneElement(s.Children.only(n),r))},t}(s.Component);function b(){}g.contextType=d,g.propTypes={},g.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:b,onEntering:b,onEntered:b,onExit:b,onExiting:b,onExited:b},g.UNMOUNTED=h,g.EXITED=u,g.ENTERING=m,g.ENTERED=p,g.EXITING=f;var v=g,y=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return r=t,void((n=e).classList?n.classList.remove(r):"string"==typeof n.className?n.className=o(n.className,r):n.setAttribute("class",o(n.className&&n.className.baseVal||"",r)));var n,r}))},w=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var r=t.resolveArguments(e,n),i=r[0],a=r[1];t.removeClasses(i,"exit"),t.addClass(i,a?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var r=t.resolveArguments(e,n),i=r[0],a=r[1]?"appear":"enter";t.addClass(i,a,"active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var r=t.resolveArguments(e,n),i=r[0],a=r[1]?"appear":"enter";t.removeClasses(i,a),t.addClass(i,a,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e)[0];t.addClass(n,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,r="string"==typeof n,i=r?""+(r&&n?n+"-":"")+e:n[e];return{baseClassName:i,activeClassName:r?i+"-active":n[e+"Active"],doneClassName:r?i+"-done":n[e+"Done"]}},t}(0,a.Z)(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var r=this.getClassNames(t)[n+"ClassName"],i=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&i&&(r+=" "+i),"active"===n&&e&&e.scrollTop,r&&(this.appliedClasses[t][n]=r,function(e,t){e&&t&&t.split(" ").forEach((function(t){return r=t,void((n=e).classList?n.classList.add(r):function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}(n,r)||("string"==typeof n.className?n.className=n.className+" "+r:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+r)));var n,r}))}(e,r))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],r=n.base,i=n.active,a=n.done;this.appliedClasses[t]={},r&&y(e,r),i&&y(e,i),a&&y(e,a)},n.render=function(){var e=this.props,t=(e.classNames,(0,i.Z)(e,["classNames"]));return s.createElement(v,(0,r.Z)({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(s.Component);w.defaultProps={classNames:""},w.propTypes={};var x=w}}]);